<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>&#31532;&nbsp;6&nbsp;&#31456;&nbsp;&#38598;&#21512;&#31867;(Collections)&#26144;&#23556;</title><link rel="stylesheet" href="../shared/css/html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.65.1"><link rel="home" href="index.html" title="HIBERNATE - &#31526;&#21512;Java&#20064;&#24815;&#30340;&#20851;&#31995;&#25968;&#25454;&#24211;&#25345;&#20037;&#21270;"><link rel="up" href="index.html" title="HIBERNATE - &#31526;&#21512;Java&#20064;&#24815;&#30340;&#20851;&#31995;&#25968;&#25454;&#24211;&#25345;&#20037;&#21270;"><link rel="previous" href="mapping.html" title="&#31532;&nbsp;5&nbsp;&#31456;&nbsp;&#23545;&#35937;/&#20851;&#31995;&#25968;&#25454;&#24211;&#26144;&#23556;&#22522;&#30784;(Basic O/R Mapping)"><link rel="next" href="associations.html" title="&#31532;&nbsp;7&nbsp;&#31456;&nbsp;&#20851;&#32852;&#20851;&#31995;&#26144;&#23556;"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">&#31532;&nbsp;6&nbsp;&#31456;&nbsp;&#38598;&#21512;&#31867;(Collections)&#26144;&#23556;</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="mapping.html">&#19978;&#19968;&#39029;</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="associations.html">&#19979;&#19968;&#39029;</a></td></tr></table><hr></div><div class="chapter" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title"><a name="collections"></a>&#31532;&nbsp;6&nbsp;&#31456;&nbsp;&#38598;&#21512;&#31867;(Collections)&#26144;&#23556;</h2></div></div><div></div></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="collections-persistent"></a>6.1.&nbsp;&#25345;&#20037;&#21270;&#38598;&#21512;&#31867;(Persistent collections)</h2></div></div><div></div></div><p><a name="collections-persistent-translate-comment"></a>
            (&#35793;&#32773;&#27880;&#65306;&#22312;&#38405;&#35835;&#26412;&#31456;&#30340;&#26102;&#20505;&#65292;&#20197;&#21518;&#25972;&#20010;&#25163;&#20876;&#30340;&#38405;&#35835;&#36807;&#31243;&#20013;&#65292;&#25105;&#20204;&#37117;&#20250;&#38754;&#20020;&#19968;&#20010;&#21517;&#35789;&#26041;&#38754;&#30340;&#38382;&#39064;&#65292;&#37027;&#23601;&#26159;&#8220;&#38598;&#21512;&#8221;&#12290;"Collections"&#21644;"Set"&#22312;&#20013;&#25991;&#37324;&#23545;&#24212;&#37117;&#34987;&#32763;&#35793;&#20026;&#8220;&#38598;&#21512;&#8221;&#65292;&#20294;&#26159;&#20182;&#20204;&#30340;&#21547;&#20041;&#24456;&#19981;&#19968;&#26679;&#12290;Collections&#26159;&#19968;&#20010;&#36229;&#38598;&#65292;Set&#26159;&#20854;&#20013;&#30340;&#19968;&#31181;&#12290;&#22823;&#37096;&#20998;&#24773;&#20917;&#19979;&#65292;&#26412;&#35793;&#31295;&#20013;&#27867;&#25351;&#30340;&#26410;&#21152;&#33521;&#25991;&#27880;&#26126;&#30340;&#8220;&#38598;&#21512;&#8221;&#65292;&#37117;&#24212;&#24403;&#29702;&#35299;&#20026;&#8220;Collections&#8221;&#12290;&#22312;&#26377;&#20123;&#20108;&#32773;&#21516;&#26102;&#20986;&#29616;&#65292;&#21487;&#33021;&#36896;&#25104;&#28151;&#28102;&#30340;&#22320;&#26041;&#65292;&#25105;&#20204;&#29992;&#8220;&#38598;&#21512;&#31867;&#8221;&#26469;&#29305;&#25351;&#8220;Collecions&#8221;,&#8220;&#38598;&#21512;(Set)&#8221;&#26469;&#25351;"Set"&#65292;&#19968;&#33324;&#37117;&#20250;&#22312;&#21518;&#38754;&#30340;&#25324;&#21495;&#20013;&#32473;&#20986;&#33521;&#25991;&#12290;&#24076;&#26395;&#22823;&#23478;&#22312;&#38405;&#35835;&#26102;&#32852;&#31995;&#19978;&#19979;&#25991;&#29702;&#35299;&#65292;&#19981;&#35201;&#36896;&#25104;&#35823;&#35299;&#12290;
            &#19982;&#27492;&#21516;&#26102;&#65292;&#8220;&#20803;&#32032;&#8221;&#19968;&#35789;&#23545;&#24212;&#30340;&#33521;&#25991;&#8220;element&#8221;&#65292;&#20063;&#26377;&#20004;&#20010;&#19981;&#21516;&#30340;&#21547;&#20041;&#12290;&#20854;&#19968;&#20026;&#38598;&#21512;&#30340;&#20803;&#32032;&#65292;&#26159;&#20869;&#23384;&#20013;&#30340;&#19968;&#20010;&#21464;&#37327;&#65307;&#21478;&#19968;&#21547;&#20041;&#21017;&#26159;XML&#25991;&#26723;&#20013;&#30340;&#19968;&#20010;&#26631;&#31614;&#25152;&#20195;&#34920;&#30340;&#20803;&#32032;&#12290;&#20063;&#35831;&#27880;&#24847;&#21306;&#21035;&#12290;
            &#26412;&#31456;&#20013;,&#29305;&#21035;&#26159;&#21518;&#21322;&#37096;&#20998;&#26159;&#38656;&#35201;&#21453;&#22797;&#38405;&#35835;&#25165;&#33021;&#29702;&#35299;&#28165;&#26970;&#30340;&#12290;&#22914;&#26524;&#36935;&#21040;&#20219;&#20309;&#30097;&#38382;,&#35831;&#35760;&#20303;,&#33521;&#25991;&#29256;&#26412;&#30340;reference&#26159;&#24799;&#19968;&#26631;&#20934;&#30340;&#21442;&#32771;&#36164;&#26009;&#12290;)
            </p><p>
            Hibernate&#35201;&#27714;&#25345;&#20037;&#21270;&#38598;&#21512;&#20540;&#23383;&#27573;&#24517;&#39035;&#22768;&#26126;&#20026;&#25509;&#21475;&#65292;&#27604;&#22914;&#65306;
        </p><pre class="programlisting">public class Product {
    private String serialNumber;
    private Set parts = new HashSet();
    
    public Set getParts() { return parts; }
    void setParts(Set parts) { this.parts = parts; }
    public String getSerialNumber() { return serialNumber; }
    void setSerialNumber(String sn) { serialNumber = sn; }
}</pre><p>
            &#23454;&#38469;&#30340;&#25509;&#21475;&#21487;&#33021;&#26159;<tt class="literal">java.util.Set</tt>,
            <tt class="literal">java.util.Collection</tt>, <tt class="literal">java.util.List</tt>,
            <tt class="literal">java.util.Map</tt>, <tt class="literal">java.util.SortedSet</tt>,
            <tt class="literal">java.util.SortedMap</tt> &#25110;&#32773;...&#20219;&#20309;&#20320;&#21916;&#27426;&#30340;&#31867;&#22411;&#65281;("&#20219;&#20309;&#20320;&#21916;&#27426;&#30340;&#31867;&#22411;" &#20195;&#34920;&#20320;&#38656;&#35201;&#32534;&#20889;           <tt class="literal">org.hibernate.usertype.UserCollectionType</tt>&#30340;&#23454;&#29616;.)
        </p><p>
            &#27880;&#24847;&#25105;&#20204;&#26159;&#22914;&#20309;&#29992;&#19968;&#20010;<tt class="literal">HashSet</tt>&#23454;&#20363;&#26469;&#21021;&#22987;&#21270;&#23454;&#20363;&#21464;&#37327;&#30340;.&#36825;&#26159;&#29992;&#20110;&#21021;&#22987;&#21270;&#26032;&#21019;&#24314;(&#23578;&#26410;&#25345;&#20037;&#21270;)&#30340;&#31867;&#23454;&#20363;&#20013;&#38598;&#21512;&#20540;&#23646;&#24615;&#30340;&#26368;&#20339;&#26041;&#27861;&#12290;&#24403;&#20320;&#25345;&#20037;&#21270;&#36825;&#20010;&#23454;&#20363;&#26102;&#8212;&#8212;&#27604;&#22914;&#36890;&#36807;&#35843;&#29992;<tt class="literal">persist()</tt>&#8212;&#8212;Hibernate &#20250;&#33258;&#21160;&#25226;<tt class="literal">HashSet</tt>&#26367;&#25442;&#20026;Hibernate&#33258;&#24049;&#30340;<tt class="literal">Set</tt>&#23454;&#29616;&#12290;&#35266;&#23519;&#19979;&#38754;&#30340;&#38169;&#35823;&#65306;
        </p><pre class="programlisting">Cat cat = new DomesticCat();
Cat kitten = new DomesticCat();
....
Set kittens = new HashSet();
kittens.add(kitten);
cat.setKittens(kittens);
session.persist(cat);
kittens = cat.getKittens(); //Okay, kittens collection is a Set
(HashSet) cat.getKittens(); //Error!</pre><p>
                    &#26681;&#25454;&#19981;&#21516;&#30340;&#25509;&#21475;&#31867;&#22411;&#65292;&#34987;Hibernate&#27880;&#23556;&#30340;&#25345;&#20037;&#21270;&#38598;&#21512;&#31867;&#30340;&#34920;&#29616;&#31867;&#20284;<tt class="literal">HashMap</tt>, <tt class="literal">HashSet</tt>,
            <tt class="literal">TreeMap</tt>, <tt class="literal">TreeSet</tt> or
            <tt class="literal">ArrayList</tt>&#12290;
		</p><p>
        	&#38598;&#21512;&#31867;&#23454;&#20363;&#20855;&#26377;&#20540;&#31867;&#22411;&#30340;&#36890;&#24120;&#34892;&#20026;&#12290;&#24403;&#34987;&#25345;&#20037;&#21270;&#23545;&#35937;&#24341;&#29992;&#21518;&#65292;&#20182;&#20204;&#20250;&#33258;&#21160;&#34987;&#25345;&#20037;&#21270;&#65292;&#24403;&#19981;&#20877;&#34987;&#24341;&#29992;&#21518;&#65292;&#33258;&#21160;&#34987;&#21024;&#38500;&#12290;&#20551;&#33509;&#23454;&#20363;&#34987;&#20174;&#19968;&#20010;&#25345;&#20037;&#21270;&#23545;&#35937;&#20256;&#36882;&#21040;&#21478;&#19968;&#20010;&#65292;&#23427;&#30340;&#20803;&#32032;&#21487;&#33021;&#20174;&#19968;&#20010;&#34920;&#36716;&#31227;&#21040;&#21478;&#19968;&#20010;&#34920;&#12290;&#20004;&#20010;&#23454;&#20307;&#19981;&#33021;&#20849;&#20139;&#21516;&#19968;&#20010;&#38598;&#21512;&#31867;&#23454;&#20363;&#30340;&#24341;&#29992;&#12290;&#22240;&#20026;&#24213;&#23618;&#20851;&#31995;&#25968;&#25454;&#24211;&#27169;&#22411;&#30340;&#21407;&#22240;&#65292;&#38598;&#21512;&#20540;&#23646;&#24615;&#26080;&#27861;&#25903;&#25345;&#31354;&#20540;&#35821;&#20041;&#65307;Hibernate&#23545;&#31354;&#30340;&#38598;&#21512;&#24341;&#29992;&#21644;&#31354;&#38598;&#21512;&#19981;&#21152;&#21306;&#21035;&#12290;
        </p><p>
        &#20320;&#19981;&#38656;&#35201;&#36807;&#22810;&#30340;&#20026;&#27492;&#25285;&#24515;&#12290;&#23601;&#22914;&#21516;&#20320;&#24179;&#26102;&#20351;&#29992;&#26222;&#36890;&#30340;Java&#38598;&#21512;&#31867;&#19968;&#26679;&#26469;&#20351;&#29992;&#25345;&#20037;&#21270;&#38598;&#21512;&#31867;&#12290;&#21482;&#26159;&#35201;&#30830;&#35748;&#20320;&#29702;&#35299;&#20102;&#21452;&#21521;&#20851;&#32852;&#30340;&#35821;&#20041;&#65288;&#21518;&#25991;&#35752;&#35770;&#65289;&#12290;
        </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="collections-mapping"></a>6.2.&nbsp;&#38598;&#21512;&#26144;&#23556;&#65288; Collection mappings &#65289;</h2></div></div><div></div></div><p>
        &#29992;&#20110;&#26144;&#23556;&#38598;&#21512;&#31867;&#30340;Hibernate&#26144;&#23556;&#20803;&#32032;&#21462;&#20915;&#20110;&#25509;&#21475;&#30340;&#31867;&#22411;&#12290;&#27604;&#22914;&#65292; <tt class="literal">&lt;set&gt;</tt> &#20803;&#32032;&#29992;&#26469;&#26144;&#23556;<tt class="literal">Set</tt>&#31867;&#22411;&#30340;&#23646;&#24615;&#12290;
        </p><pre class="programlisting">&lt;class name="Product"&gt;
    &lt;id name="serialNumber" column="productSerialNumber"/&gt;
    &lt;set name="parts"&gt;
        &lt;key column="productSerialNumber" not-null="true"/&gt;
        &lt;one-to-many class="Part"/&gt;
    &lt;/set&gt;
&lt;/class&gt;</pre><p>
        &#38500;&#20102;<tt class="literal">&lt;set&gt;</tt>,&#36824;&#26377;<tt class="literal">&lt;list&gt;</tt>, <tt class="literal">&lt;map&gt;</tt>,            <tt class="literal">&lt;bag&gt;</tt>, <tt class="literal">&lt;array&gt;</tt> &#21644;
            <tt class="literal">&lt;primitive-array&gt;</tt> &#26144;&#23556;&#20803;&#32032;&#12290;<tt class="literal">&lt;map&gt;</tt>&#20855;&#26377;&#20195;&#34920;&#24615;&#65306;
        </p><div class="programlistingco"><pre class="programlisting">&lt;map
    name="propertyName"                                         <span class="co">(1)</span>
    table="table_name"                                          <span class="co">(2)</span>
    schema="schema_name"                                        <span class="co">(3)</span>
    lazy="true|extra|false"                                     <span class="co">(4)</span>
    inverse="true|false"                                        <span class="co">(5)</span>
    cascade="all|none|save-update|delete|all-delete-orphan|delet<span class="co">(6)</span>e-orphan"
    sort="unsorted|natural|comparatorClass"                     <span class="co">(7)</span>
    order-by="column_name asc|desc"                             <span class="co">(8)</span>
    where="arbitrary sql where condition"                       <span class="co">(9)</span>
    fetch="join|select|subselect"                               <span class="co">(10)</span>
    batch-size="N"                                              <span class="co">(11)</span>
    access="field|property|ClassName"                           <span class="co">(12)</span>
    optimistic-lock="true|false"                                <span class="co">(13)</span>
    mutable="true|false"                                        <span class="co">(14)</span>
    node="element-name|."
    embed-xml="true|false"
&gt;

    &lt;key .... /&gt;
    &lt;map-key .... /&gt;
    &lt;element .... /&gt;
&lt;/map&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left">(1)</td><td valign="top" align="left"><p>
                            <tt class="literal">name</tt> &#38598;&#21512;&#23646;&#24615;&#30340;&#21517;&#31216;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(2)</td><td valign="top" align="left"><p>
							<tt class="literal">table</tt> &#65288;&#21487;&#36873;&#8212;&#8212;&#40664;&#35748;&#20026;&#23646;&#24615;&#30340;&#21517;&#31216;&#65289;&#36825;&#20010;&#38598;&#21512;&#34920;&#30340;&#21517;&#31216;(&#19981;&#33021;&#22312;&#19968;&#23545;&#22810;&#30340;&#20851;&#32852;&#20851;&#31995;&#20013;&#20351;&#29992;)
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(3)</td><td valign="top" align="left"><p>
                            <tt class="literal">schema</tt> (&#21487;&#36873;) &#34920;&#30340;schema&#30340;&#21517;&#31216;, &#20182;&#23558;&#35206;&#30422;&#22312;&#26681;&#20803;&#32032;&#20013;&#23450;&#20041;&#30340;schema
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(4)</td><td valign="top" align="left"><p>
                            <tt class="literal">lazy</tt> (&#21487;&#36873;--&#40664;&#35748;&#20026;true) &#21487;&#20197;&#29992;&#26469;&#20851;&#38381;&#24310;&#36831;&#21152;&#36733;(false)&#65292;&#25351;&#23450;&#19968;&#30452;&#20351;&#29992;&#39044;&#20808;&#25235;&#21462;,&#25110;&#32773;&#25171;&#24320;"extra-lazy" &#25235;&#21462;&#65292;&#27492;&#26102;&#22823;&#22810;&#25968;&#25805;&#20316;&#19981;&#20250;&#21021;&#22987;&#21270;&#38598;&#21512;&#31867;(&#36866;&#29992;&#20110;&#38750;&#24120;&#22823;&#30340;&#38598;&#21512;)
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(5)</td><td valign="top" align="left"><p>
                            <tt class="literal">inverse</tt> (&#21487;&#36873;&#8212;&#8212;&#40664;&#35748;&#20026;<tt class="literal">false</tt>)
                            &#26631;&#35760;&#36825;&#20010;&#38598;&#21512;&#20316;&#20026;&#21452;&#21521;&#20851;&#32852;&#20851;&#31995;&#20013;&#30340;&#26041;&#21521;&#19968;&#31471;&#12290;

                        </p></td></tr><tr><td width="5%" valign="top" align="left">(6)</td><td valign="top" align="left"><p>
                            <tt class="literal">cascade</tt> (&#21487;&#36873;&#8212;&#8212;&#40664;&#35748;&#20026;<tt class="literal">none</tt>)
                            &#35753;&#25805;&#20316;&#32423;&#32852;&#21040;&#23376;&#23454;&#20307;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(7)</td><td valign="top" align="left"><p>
                            <tt class="literal">sort</tt>(&#21487;&#36873;)&#25351;&#23450;&#38598;&#21512;&#30340;&#25490;&#24207;&#39034;&#24207;, &#20854;&#21487;&#20197;&#20026;&#33258;&#28982;&#30340;(<tt class="literal">natural</tt>)&#25110;&#32773;&#32473;&#23450;&#19968;&#20010;&#29992;&#26469;&#27604;&#36739;&#30340;&#31867;&#12290;

                        </p></td></tr><tr><td width="5%" valign="top" align="left">(8)</td><td valign="top" align="left"><p>
                            <tt class="literal">order-by</tt> (&#21487;&#36873;, &#20165;&#29992;&#20110;jdk1.4) &#25351;&#23450;&#34920;&#30340;&#23383;&#27573;(&#19968;&#20010;&#25110;&#20960;&#20010;)&#20877;&#21152;&#19978;asc&#25110;&#32773;desc(&#21487;&#36873;), &#23450;&#20041;Map,Set&#21644;Bag&#30340;&#36845;&#20195;&#39034;&#24207;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(9)</td><td valign="top" align="left"><p>
                            <tt class="literal">where</tt> (&#21487;&#36873;) &#25351;&#23450;&#20219;&#24847;&#30340;SQL where&#26465;&#20214;, &#35813;&#26465;&#20214;&#23558;&#22312;&#37325;&#26032;&#36733;&#20837;&#25110;&#32773;&#21024;&#38500;&#36825;&#20010;&#38598;&#21512;&#26102;&#20351;&#29992;(&#24403;&#38598;&#21512;&#20013;&#30340;&#25968;&#25454;&#20165;&#20165;&#26159;&#25152;&#26377;&#21487;&#29992;&#25968;&#25454;&#30340;&#19968;&#20010;&#23376;&#38598;&#26102;&#36825;&#20010;&#26465;&#20214;&#38750;&#24120;&#26377;&#29992;)
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(10)</td><td valign="top" align="left"><p>
                        <tt class="literal">fetch</tt> (&#21487;&#36873;, &#40664;&#35748;&#20026;<tt class="literal">select</tt>) &#29992;&#20110;&#22312;&#22806;&#36830;&#25509;&#25235;&#21462;&#12289;&#36890;&#36807;&#21518;&#32493;select&#25235;&#21462;&#21644;&#36890;&#36807;&#21518;&#32493;subselect&#25235;&#21462;&#20043;&#38388;&#36873;&#25321;&#12290;
                    </p></td></tr><tr><td width="5%" valign="top" align="left">(11)</td><td valign="top" align="left"><p>
                            <tt class="literal">batch-size</tt> (&#21487;&#36873;, &#40664;&#35748;&#20026;<tt class="literal">1</tt>) &#25351;&#23450;&#36890;&#36807;&#24310;&#36831;&#21152;&#36733;&#21462;&#24471;&#38598;&#21512;&#23454;&#20363;&#30340;&#25209;&#22788;&#29702;&#22359;&#22823;&#23567;&#65288;"batch size"&#65289;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(12)</td><td valign="top" align="left"><p>
                            <tt class="literal">access</tt>(&#21487;&#36873;-&#40664;&#35748;&#20026;&#23646;&#24615;property):Hibernate&#21462;&#24471;&#38598;&#21512;&#23646;&#24615;&#20540;&#26102;&#20351;&#29992;&#30340;&#31574;&#30053;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(13)</td><td valign="top" align="left"><p>
                        <tt class="literal">&#20048;&#35266;&#38145;</tt> (&#21487;&#36873; - &#40664;&#35748;&#20026; <tt class="literal">true</tt>): 
                        &#23545;&#38598;&#21512;&#30340;&#29366;&#24577;&#30340;&#25913;&#21464;&#20250;&#26159;&#21542;&#23548;&#33268;&#20854;&#25152;&#23646;&#30340;&#23454;&#20307;&#30340;&#29256;&#26412;&#22686;&#38271;&#12290; (&#23545;&#19968;&#23545;&#22810;&#20851;&#32852;&#26469;&#35828;&#65292;&#20851;&#38381;&#36825;&#20010;&#23646;&#24615;&#24120;&#24120;&#26159;&#26377;&#29702;&#30340;)
                    </p></td></tr><tr><td width="5%" valign="top" align="left">(14)</td><td valign="top" align="left"><p>
                        <tt class="literal">mutable(&#21487;&#21464;&#65289;</tt> (&#21487;&#36873; - &#40664;&#35748;&#20026;<tt class="literal">true</tt>): 
                        &#33509;&#20540;&#20026;<tt class="literal">false</tt>,&#34920;&#26126;&#38598;&#21512;&#20013;&#30340;&#20803;&#32032;&#19981;&#20250;&#25913;&#21464;&#65288;&#22312;&#26576;&#20123;&#24773;&#20917;&#19979;&#21487;&#20197;&#36827;&#34892;&#19968;&#20123;&#23567;&#30340;&#24615;&#33021;&#20248;&#21270;&#65289;&#12290;
                    </p></td></tr></table></div></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="collections-foreignkeys"></a>6.2.1.&nbsp;&#38598;&#21512;&#22806;&#38190;(Collection foreign keys)</h3></div></div><div></div></div><p>
            &#38598;&#21512;&#23454;&#20363;&#22312;&#25968;&#25454;&#24211;&#20013;&#20381;&#38752;&#25345;&#26377;&#38598;&#21512;&#30340;&#23454;&#20307;&#30340;&#22806;&#38190;&#21152;&#20197;&#36776;&#21035;&#12290;&#27492;&#22806;&#38190;&#20316;&#20026;<span class="emphasis"><em>&#38598;&#21512;&#20851;&#38190;&#23383;&#27573;&#65288;collection key column&#65289;</em></span>&#65288;&#25110;&#22810;&#20010;&#23383;&#27573;&#65289;&#21152;&#20197;&#24341;&#29992;&#12290;&#38598;&#21512;&#20851;&#38190;&#23383;&#27573;&#36890;&#36807;<tt class="literal">&lt;key&gt;</tt> &#20803;&#32032;&#26144;&#23556;&#12290;
            </p><p>
                &#22312;&#22806;&#38190;&#23383;&#27573;&#19978;&#21487;&#33021;&#20855;&#26377;&#38750;&#31354;&#32422;&#26463;&#12290;&#23545;&#20110;&#22823;&#22810;&#25968;&#38598;&#21512;&#26469;&#35828;&#65292;&#36825;&#26159;&#38544;&#21547;&#30340;&#12290;&#23545;&#21333;&#21521;&#19968;&#23545;&#22810;&#20851;&#32852;&#26469;&#35828;&#65292;&#22806;&#38190;&#23383;&#27573;&#40664;&#35748;&#26159;&#21487;&#20197;&#20026;&#31354;&#30340;&#65292;&#22240;&#27492;&#20320;&#21487;&#33021;&#38656;&#35201;&#25351;&#26126; <tt class="literal">not-null="true"</tt>&#12290;
            </p><pre class="programlisting">&lt;key column="productSerialNumber" not-null="true"/&gt;</pre><p>
                &#22806;&#38190;&#32422;&#26463;&#21487;&#20197;&#20351;&#29992;<tt class="literal">ON DELETE CASCADE</tt>&#12290;
            </p><pre class="programlisting">&lt;key column="productSerialNumber" on-delete="cascade"/&gt;</pre><p>
                &#23545;<tt class="literal">&lt;key&gt;</tt> &#20803;&#32032;&#30340;&#23436;&#25972;&#23450;&#20041;&#65292;&#35831;&#21442;&#38405;&#21069;&#38754;&#30340;&#31456;&#33410;&#12290;
            </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="collections-elements"></a>6.2.2.&nbsp;&#38598;&#21512;&#20803;&#32032;&#65288;Collection elements&#65289;</h3></div></div><div></div></div><p>
              &#38598;&#21512;&#20960;&#20046;&#21487;&#20197;&#21253;&#21547;&#20219;&#20309;&#20854;&#20182;&#30340;Hibernate&#31867;&#22411;&#65292;&#21253;&#25324;&#25152;&#26377;&#30340;&#22522;&#26412;&#31867;&#22411;&#12289;&#33258;&#23450;&#20041;&#31867;&#22411;&#12289;&#32452;&#20214;&#65292;&#24403;&#28982;&#36824;&#26377;&#23545;&#20854;&#20182;&#23454;&#20307;&#30340;&#24341;&#29992;&#12290;&#23384;&#22312;&#19968;&#20010;&#37325;&#35201;&#30340;&#21306;&#21035;&#65306;&#20301;&#20110;&#38598;&#21512;&#20013;&#30340;&#23545;&#35937;&#21487;&#33021;&#26159;&#26681;&#25454;&#8220;&#20540;&#8221;&#35821;&#20041;&#26469;&#25805;&#20316;&#65288;&#20854;&#22768;&#26126;&#21608;&#26399;&#23436;&#20840;&#20381;&#36182;&#20110;&#38598;&#21512;&#25345;&#26377;&#32773;&#65289;&#65292;&#25110;&#32773;&#23427;&#21487;&#33021;&#26159;&#25351;&#21521;&#21478;&#19968;&#20010;&#23454;&#20307;&#30340;&#24341;&#29992;&#65292;&#20855;&#26377;&#20854;&#33258;&#24049;&#30340;&#29983;&#21629;&#21608;&#26399;&#12290;&#22312;&#21518;&#32773;&#30340;&#24773;&#20917;&#19979;&#65292;&#34987;&#20316;&#20026;&#38598;&#21512;&#25345;&#26377;&#30340;&#29366;&#24577;&#32771;&#34385;&#30340;&#65292;&#21482;&#26377;&#20004;&#20010;&#23545;&#35937;&#20043;&#38388;&#30340;&#8220;&#36830;&#25509;&#8221;&#12290;
            </p><p>
                &#34987;&#21253;&#23481;&#30340;&#31867;&#22411;&#34987;&#31216;&#20026;<span class="emphasis"><em>&#38598;&#21512;&#20803;&#32032;&#31867;&#22411;&#65288;collection element type&#65289;</em></span>&#12290;&#38598;&#21512;&#20803;&#32032;&#36890;&#36807;<tt class="literal">&lt;element&gt;</tt>&#25110;<tt class="literal">&lt;composite-element&gt;</tt>&#26144;&#23556;&#65292;&#25110;&#22312;&#20854;&#26159;&#23454;&#20307;&#24341;&#29992;&#30340;&#26102;&#20505;&#65292;&#36890;&#36807;<tt class="literal">&lt;one-to-many&gt;</tt> &#25110;<tt class="literal">&lt;many-to-many&gt;</tt>&#26144;&#23556;&#12290;&#21069;&#20004;&#31181;&#29992;&#20110;&#20351;&#29992;&#20540;&#35821;&#20041;&#26144;&#23556;&#20803;&#32032;&#65292;&#21518;&#20004;&#31181;&#29992;&#20110;&#26144;&#23556;&#23454;&#20307;&#20851;&#32852;&#12290;
            </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="collections-indexed"></a>6.2.3.&nbsp;&#32034;&#24341;&#38598;&#21512;&#31867;(Indexed collections)</h3></div></div><div></div></div><p>
             &#25152;&#26377;&#30340;&#38598;&#21512;&#26144;&#23556;&#65292;&#38500;&#20102;set&#21644;bag&#35821;&#20041;&#30340;&#20197;&#22806;&#65292;&#37117;&#38656;&#35201;&#25351;&#23450;&#19968;&#20010;&#38598;&#21512;&#34920;&#30340;<span class="emphasis"><em>&#32034;&#24341;&#23383;&#27573;(index column)</em></span>&#8212;&#8212;&#29992;&#20110;&#23545;&#24212;&#21040;&#25968;&#32452;&#32034;&#24341;&#65292;&#25110;&#32773;<tt class="literal">List</tt>&#30340;&#32034;&#24341;&#65292;&#25110;&#32773;<tt class="literal">Map</tt>&#30340;&#20851;&#38190;&#23383;&#12290;&#36890;&#36807;<tt class="literal">&lt;map-key&gt;</tt>,<tt class="literal">Map</tt> &#30340;&#32034;&#24341;&#21487;&#20197;&#26159;&#20219;&#20309;&#22522;&#30784;&#31867;&#22411;&#65307;&#33509;&#36890;&#36807;<tt class="literal">&lt;map-key-many-to-many&gt;</tt>&#65292;&#23427;&#20063;&#21487;&#20197;&#26159;&#19968;&#20010;&#23454;&#20307;&#24341;&#29992;&#65307;&#33509;&#36890;&#36807;<tt class="literal">&lt;composite-map-key&gt;</tt>&#65292;&#23427;&#36824;&#21487;&#20197;&#26159;&#19968;&#20010;&#32452;&#21512;&#31867;&#22411;&#12290;&#25968;&#32452;&#25110;&#21015;&#34920;&#30340;&#32034;&#24341;&#24517;&#39035;&#26159;<tt class="literal">integer</tt>&#31867;&#22411;&#65292;&#24182;&#19988;&#20351;&#29992; <tt class="literal">&lt;list-index&gt;</tt>&#20803;&#32032;&#23450;&#20041;&#26144;&#23556;&#12290;&#34987;&#26144;&#23556;&#30340;&#23383;&#27573;&#21253;&#21547;&#26377;&#39034;&#24207;&#25490;&#21015;&#30340;&#25972;&#25968;&#65288;&#40664;&#35748;&#20174;0&#24320;&#22987;&#65289;&#12290;
            </p><div class="programlistingco"><pre class="programlisting">&lt;map-key 
        column="column_name"                <span class="co">(1)</span>
        formula="any SQL expression"        <span class="co">(2)</span>
        type="type_name"                    <span class="co">(3)</span>
        node="@attribute-name"
        length="N"/&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left">(1)</td><td valign="top" align="left"><p>
                            <tt class="literal">column</tt>(&#21487;&#36873;):&#20445;&#23384;&#38598;&#21512;&#32034;&#24341;&#20540;&#30340;&#23383;&#27573;&#21517;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(2)</td><td valign="top" align="left"><p>
                        <tt class="literal">formula</tt> (&#21487;&#36873;): &#29992;&#20110;&#35745;&#31639;map&#20851;&#38190;&#23383;&#30340;SQL&#20844;&#24335;
                    </p></td></tr><tr><td width="5%" valign="top" align="left">(3)</td><td valign="top" align="left"><p>
                            <tt class="literal">type</tt> (&#24517;&#39035;):&#26144;&#23556;&#38190;(map key)&#30340;&#31867;&#22411;&#12290;
                        </p></td></tr></table></div></div><div class="programlistingco"><pre class="programlisting">&lt;map-key-many-to-many
        column="column_name"                <span class="co">(1)</span>
        formula="any SQL expression"        <span class="co">(2)</span><span class="co">(3)</span>
        class="ClassName"
/&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left">(1)</td><td valign="top" align="left"><p>
							<tt class="literal">column</tt>(&#21487;&#36873;):&#38598;&#21512;&#32034;&#24341;&#20540;&#20013;&#22806;&#38190;&#23383;&#27573;&#30340;&#21517;&#31216;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(2)</td><td valign="top" align="left"><p>
                        <tt class="literal">formula</tt> (&#21487;&#36873;): &#29992;&#20110;&#35745;&#31639;map&#20851;&#38190;&#23383;&#30340;&#22806;&#38190;&#30340;SQL&#20844;&#24335;
                    </p></td></tr><tr><td width="5%" valign="top" align="left">(3)</td><td valign="top" align="left"><p>
                            <tt class="literal">class</tt> (&#24517;&#38656;):&#26144;&#23556;&#30340;&#38190;(map key)&#20351;&#29992;&#30340;&#23454;&#20307;&#31867;&#12290;
                        </p></td></tr></table></div></div><p>
            &#20551;&#33509;&#20320;&#30340;&#34920;&#27809;&#26377;&#19968;&#20010;&#32034;&#24341;&#23383;&#27573;,&#24403;&#20320;&#20173;&#28982;&#24076;&#26395;&#20351;&#29992;<tt class="literal">List</tt>&#20316;&#20026;&#23646;&#24615;&#31867;&#22411;,&#20320;&#24212;&#35813;&#25226;&#27492;&#23646;&#24615;&#26144;&#23556;&#20026;Hibernate <span class="emphasis"><em>&lt;bag&gt;</em></span>&#12290;&#20174;&#25968;&#25454;&#24211;&#20013;&#33719;&#21462;&#30340;&#26102;&#20505;&#65292;bag&#19981;&#32500;&#25252;&#20854;&#39034;&#24207;&#65292;&#20294;&#20063;&#21487;&#36873;&#25321;&#24615;&#30340;&#36827;&#34892;&#25490;&#24207;&#12290;
            </p></div><p>
        &#20174;&#38598;&#21512;&#31867;&#21487;&#20197;&#20135;&#29983;&#24456;&#22823;&#19968;&#37096;&#20998;&#26144;&#23556;&#65292;&#35206;&#30422;&#20102;&#24456;&#22810;&#24120;&#35265;&#30340;&#20851;&#31995;&#27169;&#22411;&#12290;&#25105;&#20204;&#24314;&#35758;&#20320;&#35797;&#39564;schema&#29983;&#25104;&#24037;&#20855;&#65292;&#26469;&#20307;&#20250;&#19968;&#19979;&#19981;&#21516;&#30340;&#26144;&#23556;&#22768;&#26126;&#26159;&#22914;&#20309;&#34987;&#32763;&#35793;&#20026;&#25968;&#25454;&#24211;&#34920;&#30340;&#12290;
        </p><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="collections-ofvalues"></a>6.2.4.&nbsp;&#20540;&#38598;&#21512;&#20110;&#22810;&#23545;&#22810;&#20851;&#32852;(Collections of values and many-to-many associations)</h3></div></div><div></div></div><p>
        &#20219;&#20309;&#20540;&#38598;&#21512;&#25110;&#32773;&#22810;&#23545;&#22810;&#20851;&#32852;&#38656;&#35201;&#19987;&#29992;&#30340;&#20855;&#26377;&#19968;&#20010;&#25110;&#22810;&#20010;&#22806;&#38190;&#23383;&#27573;&#30340;<span class="emphasis"><em>collection table</em></span>&#12289;&#19968;&#20010;&#25110;&#22810;&#20010;<span class="emphasis"><em>collection element column</em></span>&#65292;&#20197;&#21450;&#36824;&#21487;&#33021;&#26377;&#19968;&#20010;&#25110;&#22810;&#20010;&#32034;&#24341;&#23383;&#27573;&#12290;
        </p><p>
                &#23545;&#20110;&#19968;&#20010;&#20540;&#38598;&#21512;, &#25105;&#20204;&#20351;&#29992;<tt class="literal">&lt;element&gt;</tt>&#26631;&#31614;&#12290;
            </p><div class="programlistingco"><pre class="programlisting">&lt;element
        column="column_name"                     <span class="co">(1)</span>
        formula="any SQL expression"             <span class="co">(2)</span>
        type="typename"                          <span class="co">(3)</span>
        length="L"
        precision="P"
        scale="S"
        not-null="true|false"
        unique="true|false"
        node="element-name"
/&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left">(1)</td><td valign="top" align="left"><p>
                            <tt class="literal">column</tt>(&#21487;&#36873;):&#20445;&#23384;&#38598;&#21512;&#20803;&#32032;&#20540;&#30340;&#23383;&#27573;&#21517;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(2)</td><td valign="top" align="left"><p>
                        <tt class="literal">formula</tt> (&#21487;&#36873;): &#29992;&#20110;&#35745;&#31639;&#20803;&#32032;&#30340;SQL&#20844;&#24335;                    
                       </p></td></tr><tr><td width="5%" valign="top" align="left">(3)</td><td valign="top" align="left"><p>
                            <tt class="literal">type</tt> (&#24517;&#38656;):&#38598;&#21512;&#20803;&#32032;&#30340;&#31867;&#22411;
                        </p></td></tr></table></div></div><p>
            <span class="emphasis"><em>&#22810;&#23545;&#22810;&#20851;&#32852;(many-to-many association)</em></span> &#20351;&#29992;
            <tt class="literal">&lt;many-to-many&gt;</tt>&#20803;&#32032;&#23450;&#20041;.
        </p><div class="programlistingco"><pre class="programlisting">&lt;many-to-many
        column="column_name"                               <span class="co">(1)</span>
        formula="any SQL expression"                       <span class="co">(2)</span>
        class="ClassName"                                  <span class="co">(3)</span>
        fetch="select|join"                                <span class="co">(4)</span>
        unique="true|false"                                <span class="co">(5)</span>
        not-found="ignore|exception"                       <span class="co">(6)</span>
        entity-name="EntityName"                           <span class="co">(7)</span>
        property-ref="propertyNameFromAssociatedClass"     <span class="co">(8)</span>
        node="element-name"
        embed-xml="true|false"
    /&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left">(1)</td><td valign="top" align="left"><p>
                            <tt class="literal">column</tt>(&#21487;&#36873;): &#36825;&#20010;&#20803;&#32032;&#30340;&#22806;&#38190;&#20851;&#38190;&#23383;&#27573;&#21517;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(2)</td><td valign="top" align="left"><p>
                        <tt class="literal">formula</tt> (&#21487;&#36873;): &#29992;&#20110;&#35745;&#31639;&#20803;&#32032;&#22806;&#38190;&#20540;&#30340;SQL&#20844;&#24335;.
                    </p></td></tr><tr><td width="5%" valign="top" align="left">(3)</td><td valign="top" align="left"><p>
                            <tt class="literal">class</tt> (&#24517;&#38656;): &#20851;&#32852;&#31867;&#30340;&#21517;&#31216;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(3)</td><td valign="top" align="left"><p>
							<tt class="literal">outer-join</tt> (&#21487;&#36873; - &#40664;&#35748;&#20026;<tt class="literal">auto</tt>):
							&#22312;Hibernate&#31995;&#32479;&#21442;&#25968;&#20013;<tt class="literal">hibernate.use_outer_join</tt>&#34987;&#25171;&#24320;&#30340;&#24773;&#20917;&#19979;,&#35813;&#21442;&#25968;&#29992;&#26469;&#20801;&#35768;&#20351;&#29992;outer join&#26469;&#36733;&#20837;&#27492;&#38598;&#21512;&#30340;&#25968;&#25454;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(4)</td><td valign="top" align="left"><p>
                        &#20026;&#27492;&#20851;&#32852;&#25171;&#24320;&#22806;&#36830;&#25509;&#25235;&#21462;&#25110;&#32773;&#21518;&#32493;select&#25235;&#21462;&#12290;&#36825;&#26159;&#29305;&#27530;&#24773;&#20917;&#65307;&#23545;&#20110;&#19968;&#20010;&#23454;&#20307;&#21450;&#20854;&#25351;&#21521;&#20854;&#20182;&#23454;&#20307;&#30340;&#22810;&#23545;&#22810;&#20851;&#32852;&#36827;&#20840;&#39044;&#20808;&#25235;&#21462;&#65288;&#20351;&#29992;&#19968;&#26465;&#21333;&#29420;&#30340;<tt class="literal">SELECT</tt>)&#65292;&#20320;&#19981;&#20165;&#38656;&#35201;&#23545;&#38598;&#21512;&#33258;&#36523;&#25171;&#24320;<tt class="literal">join</tt>&#65292;&#20063;&#38656;&#35201;&#23545;<tt class="literal">&lt;many-to-many&gt;</tt>&#36825;&#20010;&#20869;&#23884;&#20803;&#32032;&#25171;&#24320;&#27492;&#23646;&#24615;&#12290;
                    </p></td></tr><tr><td width="5%" valign="top" align="left">(5)</td><td valign="top" align="left"><p>
                        &#23545;&#22806;&#38190;&#23383;&#27573;&#20801;&#35768;DDL&#29983;&#25104;&#30340;&#26102;&#20505;&#29983;&#25104;&#19968;&#20010;&#24799;&#19968;&#32422;&#26463;&#12290;&#36825;&#20351;&#20851;&#32852;&#21464;&#25104;&#20102;&#19968;&#20010;&#39640;&#25928;&#30340;&#19968;&#23545;&#22810;&#20851;&#32852;&#12290;&#65288;&#27492;&#21477;&#23384;&#30097;&#65306;&#21407;&#25991;&#20026;This makes the association multiplicity effectively one to many.)
                    </p></td></tr><tr><td width="5%" valign="top" align="left">(6)</td><td valign="top" align="left"><p>
	                    <tt class="literal">not-found</tt> (&#21487;&#36873; - &#40664;&#35748;&#20026; <tt class="literal">exception</tt>): &#25351;&#26126;&#24341;&#29992;&#30340;&#22806;&#38190;&#20013;&#32570;&#23569;&#26576;&#20123;&#34892;&#35813;&#22914;&#20309;&#22788;&#29702;&#65306;
	                    <tt class="literal">ignore</tt> &#20250;&#25226;&#32570;&#22833;&#30340;&#34892;&#20316;&#20026;&#19968;&#20010;&#31354;&#24341;&#29992;&#22788;&#29702;&#12290;
	                </p></td></tr><tr><td width="5%" valign="top" align="left">(7)</td><td valign="top" align="left"><p>
                        <tt class="literal">entity-name</tt> (&#21487;&#36873;): &#34987;&#20851;&#32852;&#30340;&#31867;&#30340;&#23454;&#20307;&#21517;&#65292;&#20316;&#20026;<tt class="literal">class</tt>&#30340;&#26367;&#20195;&#12290;
                    </p></td></tr><tr><td width="5%" valign="top" align="left">(8)</td><td valign="top" align="left"><p>
                        <tt class="literal">property-ref</tt>: (&#21487;&#36873;) &#34987;&#20851;&#32852;&#21040;&#27492;&#22806;&#38190;(foreign key)&#30340;&#31867;&#20013;&#30340;&#23545;&#24212;&#23646;&#24615;&#30340;&#21517;&#23383;&#12290;&#33509;&#26410;&#25351;&#23450;&#65292;&#20351;&#29992;&#34987;&#20851;&#32852;&#31867;&#30340;&#20027;&#38190;&#12290;
                    </p></td></tr></table></div></div><p>
                &#20363;&#23376;&#65306;&#39318;&#20808;, &#19968;&#32452;&#23383;&#31526;&#20018;&#65306;
            </p><pre class="programlisting">&lt;set name="names" table="NAMES"&gt;
    &lt;key column="GROUPID"/&gt;
    &lt;element column="NAME" type="string"/&gt;
&lt;/set&gt;</pre><p>
                &#21253;&#21547;&#19968;&#32452;&#25972;&#25968;&#30340;bag(&#36824;&#35774;&#32622;&#20102;<tt class="literal">order-by</tt>&#21442;&#25968;&#25351;&#23450;&#20102;&#36845;&#20195;&#30340;&#39034;&#24207;)&#65306;
            </p><pre class="programlisting">&lt;bag name="sizes" 
        table="item_sizes" 
        order-by="size asc"&gt;
    &lt;key column="item_id"/&gt;
    &lt;element column="size" type="integer"/&gt;
&lt;/bag&gt;</pre><p>
                &#19968;&#20010;&#23454;&#20307;&#25968;&#32452;,&#22312;&#36825;&#20010;&#26696;&#20363;&#20013;&#26159;&#19968;&#20010;&#22810;&#23545;&#22810;&#30340;&#20851;&#32852;(&#27880;&#24847;&#36825;&#37324;&#30340;&#23454;&#20307;&#26159;&#33258;&#21160;&#31649;&#29702;&#29983;&#21629;&#21608;&#26399;&#30340;&#23545;&#35937;&#65288;lifecycle objects&#65289;,<tt class="literal">cascade="all"</tt>):
            </p><pre class="programlisting">&lt;array name="addresses" 
        table="PersonAddress" 
        cascade="persist"&gt;
    &lt;key column="personId"/&gt;
    &lt;list-index column="sortOrder"/&gt;
    &lt;many-to-many column="addressId" class="Address"/&gt;
&lt;/array&gt;</pre><p>
                &#19968;&#20010;map,&#36890;&#36807;&#23383;&#31526;&#20018;&#30340;&#32034;&#24341;&#26469;&#25351;&#26126;&#26085;&#26399;&#65306;
            </p><pre class="programlisting">&lt;map name="holidays" 
        table="holidays" 
        schema="dbo" 
        order-by="hol_name asc"&gt;
    &lt;key column="id"/&gt;
    &lt;map-key column="hol_name" type="string"/&gt;
    &lt;element column="hol_date" type="date"/&gt;
&lt;/map&gt;</pre><p>
                &#19968;&#20010;&#32452;&#20214;&#30340;&#21015;&#34920;&#65306;&#65288;&#19979;&#19968;&#31456;&#35752;&#35770;&#65289;
            </p><pre class="programlisting">&lt;list name="carComponents" 
        table="CarComponents"&gt;
    &lt;key column="carId"/&gt;
    &lt;list-index column="sortOrder"/&gt;
    &lt;composite-element class="CarComponent"&gt;
        &lt;property name="price"/&gt;
        &lt;property name="type"/&gt;
        &lt;property name="serialNumber" column="serialNum"/&gt;
    &lt;/composite-element&gt;
&lt;/list&gt;</pre></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="collections-onetomany"></a>6.2.5.&nbsp;&#19968;&#23545;&#22810;&#20851;&#32852;&#65288;One-to-many Associations&#65289;</h3></div></div><div></div></div><p>
                <span class="emphasis"><em>&#19968;&#23545;&#22810;&#20851;&#32852;</em></span><span class="emphasis"><em>&#36890;&#36807;&#22806;&#38190;</em></span>&#36830;&#25509;&#20004;&#20010;&#31867;&#23545;&#24212;&#30340;&#34920;,&#32780;&#27809;&#26377;&#20013;&#38388;&#38598;&#21512;&#34920;&#12290; &#36825;&#20010;&#20851;&#31995;&#27169;&#22411;&#22833;&#21435;&#20102;&#19968;&#20123;Java&#38598;&#21512;&#30340;&#35821;&#20041;:
            </p><div class="itemizedlist"><ul type="disc" compact><li><p>
                        &#19968;&#20010;&#34987;&#21253;&#21547;&#30340;&#23454;&#20307;&#30340;&#23454;&#20363;&#21482;&#33021;&#34987;&#21253;&#21547;&#22312;&#19968;&#20010;&#38598;&#21512;&#30340;&#23454;&#20363;&#20013;
                    </p></li><li><p>
                        &#19968;&#20010;&#34987;&#21253;&#21547;&#30340;&#23454;&#20307;&#30340;&#23454;&#20363;&#21482;&#33021;&#23545;&#24212;&#20110;&#38598;&#21512;&#32034;&#24341;&#30340;&#19968;&#20010;&#20540;&#20013;
                    </p></li></ul></div><p>
                &#19968;&#20010;&#20174;<tt class="literal">Product</tt>&#21040;<tt class="literal">Part</tt>&#30340;&#20851;&#32852;&#38656;&#35201;&#20851;&#38190;&#23383;&#23383;&#27573;,&#21487;&#33021;&#36824;&#26377;&#19968;&#20010;&#32034;&#24341;&#23383;&#27573;&#25351;&#21521;<tt class="literal">Part</tt>&#25152;&#23545;&#24212;&#30340;&#34920;&#12290; <tt class="literal">&lt;one-to-many&gt;</tt>&#26631;&#35760;&#25351;&#26126;&#20102;&#19968;&#20010;&#19968;&#23545;&#22810;&#30340;&#20851;&#32852;&#12290;
            </p><div class="programlistingco"><pre class="programlisting">&lt;one-to-many 
        class="ClassName"                                  <span class="co">(1)</span>
        not-found="ignore|exception"                       <span class="co">(2)</span>
        entity-name="EntityName"                           <span class="co">(3)</span>
        node="element-name"
        embed-xml="true|false"
    /&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left">(1)</td><td valign="top" align="left"><p>
                            <tt class="literal">class</tt>(&#24517;&#39035;):&#34987;&#20851;&#32852;&#31867;&#30340;&#21517;&#31216;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(2)</td><td valign="top" align="left"><p>
		                <tt class="literal">not-found</tt> (&#21487;&#36873; - &#40664;&#35748;&#20026;<tt class="literal">exception</tt>): 
		               &#25351;&#26126;&#33509;&#32531;&#23384;&#30340;&#26631;&#31034;&#20540;&#20851;&#32852;&#30340;&#34892;&#32570;&#22833;,&#35813;&#22914;&#20309;&#22788;&#29702;:
		                <tt class="literal">ignore</tt> &#20250;&#25226;&#32570;&#22833;&#30340;&#34892;&#20316;&#20026;&#19968;&#20010;&#31354;&#20851;&#32852;&#22788;&#29702;&#12290;
		            </p></td></tr><tr><td width="5%" valign="top" align="left">(3)</td><td valign="top" align="left"><p>
                        <tt class="literal">entity-name</tt> (&#21487;&#36873;): &#34987;&#20851;&#32852;&#30340;&#31867;&#30340;&#23454;&#20307;&#21517;&#65292;&#20316;&#20026;<tt class="literal">class</tt>&#30340;&#26367;&#20195;&#12290;
                    </p></td></tr></table></div></div><p>
                &#20363;&#23376;
            </p><pre class="programlisting">&lt;set name="bars"&gt;
    &lt;key column="foo_id"/&gt;
    &lt;one-to-many class="org.hibernate.Bar"/&gt;
&lt;/set&gt;</pre><p>
                &#27880;&#24847;:<tt class="literal">&lt;one-to-many&gt;</tt>&#20803;&#32032;&#19981;&#38656;&#35201;&#23450;&#20041;&#20219;&#20309;&#23383;&#27573;&#12290; &#20063;&#19981;&#38656;&#35201;&#25351;&#23450;&#34920;&#21517;&#12290;
                
            </p><p>
                <span class="emphasis"><em>&#37325;&#35201;&#25552;&#31034;</em></span>:&#22914;&#26524;<tt class="literal">&#19968;&#23545;&#22810;</tt>&#20851;&#32852;&#20013;&#30340;&#22806;&#38190;&#23383;&#27573;&#23450;&#20041;&#25104;<tt class="literal">NOT NULL</tt>,&#20320;&#24517;&#39035;&#25226;<tt class="literal">&lt;key&gt;</tt>&#26144;&#23556;&#22768;&#26126;&#20026;<tt class="literal">not-null="true"</tt>,&#25110;&#32773;&#20351;&#29992;<span class="emphasis"><em>&#21452;&#21521;&#20851;&#32852;</em></span>&#65292;&#24182;&#19988;&#26631;&#26126;<tt class="literal">inverse="true"</tt>&#12290;&#21442;&#38405;&#26412;&#31456;&#21518;&#38754;&#20851;&#20110;&#21452;&#21521;&#20851;&#32852;&#30340;&#35752;&#35770;&#12290;
            </p><p>
            &#19979;&#38754;&#30340;&#20363;&#23376;&#23637;&#31034;&#19968;&#20010;<tt class="literal">Part</tt>&#23454;&#20307;&#30340;map,&#25226;name&#20316;&#20026;&#20851;&#38190;&#23383;&#12290;(  <tt class="literal">partName</tt> &#26159;<tt class="literal">Part</tt>&#30340;&#25345;&#20037;&#21270;&#23646;&#24615;)&#12290;&#27880;&#24847;&#20854;&#20013;&#30340;&#22522;&#20110;&#20844;&#24335;&#30340;&#32034;&#24341;&#30340;&#29992;&#27861;&#12290;
        </p><pre class="programlisting">&lt;map name="parts"
        cascade="all"&gt;
    &lt;key column="productId" not-null="true"/&gt;
    &lt;map-key formula="partName"/&gt;
    &lt;one-to-many class="Part"/&gt;
&lt;/map&gt;</pre></div></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="collections-advancedmappings"></a>6.3.&nbsp;&#39640;&#32423;&#38598;&#21512;&#26144;&#23556;&#65288;Advanced collection mappings&#65289;</h2></div></div><div></div></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="collections-sorted"></a>6.3.1.&nbsp;&#26377;&#24207;&#38598;&#21512;&#65288;Sorted collections&#65289;</h3></div></div><div></div></div><p>
                Hibernate&#25903;&#25345;&#23454;&#29616;<tt class="literal">java.util.SortedMap</tt>&#21644;<tt class="literal">java.util.SortedSet</tt>&#30340;&#38598;&#21512;&#12290;
&#20320;&#24517;&#39035;&#22312;&#26144;&#23556;&#25991;&#20214;&#20013;&#25351;&#23450;&#19968;&#20010;&#27604;&#36739;&#22120;&#65306;
            </p><pre class="programlisting">&lt;set name="aliases" 
            table="person_aliases" 
            sort="natural"&gt;
    &lt;key column="person"/&gt;
    &lt;element column="name" type="string"/&gt;
&lt;/set&gt;

&lt;map name="holidays" sort="my.custom.HolidayComparator"&gt;
    &lt;key column="year_id"/&gt;
    &lt;map-key column="hol_name" type="string"/&gt;
    &lt;element column="hol_date" type="date"/&gt;
&lt;/map&gt;</pre><p>
                <tt class="literal">sort</tt>&#23646;&#24615;&#20013;&#20801;&#35768;&#30340;&#20540;&#21253;&#25324;<tt class="literal">unsorted</tt>,<tt class="literal">natural</tt>&#21644;&#26576;&#20010;&#23454;&#29616;&#20102;<tt class="literal">java.util.Comparator</tt>&#30340;&#31867;&#30340;&#21517;&#31216;&#12290;
            </p><p>
                &#20998;&#31867;&#38598;&#21512;&#30340;&#34892;&#20026;&#20107;&#23454;&#19978;&#35937;<tt class="literal">java.util.TreeSet</tt>&#25110;&#32773;<tt class="literal">java.util.TreeMap</tt>&#12290;
            </p><p>
                &#22914;&#26524;&#20320;&#24076;&#26395;&#25968;&#25454;&#24211;&#33258;&#24049;&#23545;&#38598;&#21512;&#20803;&#32032;&#25490;&#24207;&#65292;&#21487;&#20197;&#21033;&#29992;<tt class="literal">set</tt>,<tt class="literal">bag</tt>&#25110;&#32773;<tt class="literal">map</tt>&#26144;&#23556;&#20013;&#30340;<tt class="literal">order-by</tt>&#23646;&#24615;&#12290;&#36825;&#20010;&#35299;&#20915;&#26041;&#26696;&#21482;&#33021;&#22312;jdk1.4&#25110;&#32773;&#26356;&#39640;&#30340;jdk&#29256;&#26412;&#20013;&#25165;&#21487;&#20197;&#23454;&#29616;(&#36890;&#36807;LinkedHashSet&#25110;&#32773;
LinkedHashMap&#23454;&#29616;)&#12290; &#23427;&#26159;&#22312;SQL&#26597;&#35810;&#20013;&#23436;&#25104;&#25490;&#24207;&#65292;&#32780;&#19981;&#26159;&#22312;&#20869;&#23384;&#20013;&#12290;
            </p><pre class="programlisting">&lt;set name="aliases" table="person_aliases" order-by="lower(name) asc"&gt;
    &lt;key column="person"/&gt;
    &lt;element column="name" type="string"/&gt;
&lt;/set&gt;

&lt;map name="holidays" order-by="hol_date, hol_name"&gt;
    &lt;key column="year_id"/&gt;
    &lt;map-key column="hol_name" type="string"/&gt;
    &lt;element column="hol_date" type="date"/&gt;
&lt;/map&gt;</pre><p>
                &#27880;&#24847;: &#36825;&#20010;<tt class="literal">order-by</tt>&#23646;&#24615;&#30340;&#20540;&#26159;&#19968;&#20010;SQL&#25490;&#24207;&#23376;&#21477;&#32780;&#19981;&#26159;HQL&#30340;&#65281;
            </p><p>
                &#20851;&#32852;&#36824;&#21487;&#20197;&#22312;&#36816;&#34892;&#26102;&#20351;&#29992;&#38598;&#21512;<tt class="literal">filter()</tt>&#26681;&#25454;&#20219;&#24847;&#30340;&#26465;&#20214;&#26469;&#25490;&#24207;&#12290;
            </p><pre class="programlisting">sortedUsers = s.createFilter( group.getUsers(), "order by this.name" ).list();</pre></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="collections-bidirectional"></a>6.3.2.&nbsp;&#21452;&#21521;&#20851;&#32852;&#65288;Bidirectional associations&#65289;</h3></div></div><div></div></div><p>
                <span class="emphasis"><em>&#21452;&#21521;&#20851;&#32852;</em></span>&#20801;&#35768;&#36890;&#36807;&#20851;&#32852;&#30340;&#20219;&#19968;&#31471;&#35775;&#38382;&#21478;&#22806;&#19968;&#31471;&#12290;&#22312;Hibernate&#20013;, &#25903;&#25345;&#20004;&#31181;&#31867;&#22411;&#30340;&#21452;&#21521;&#20851;&#32852;:

                </p><div class="variablelist"><dl><dt><span class="term">&#19968;&#23545;&#22810;&#65288;one-to-many&#65289;</span></dt><dd><p>
						    Set&#25110;&#32773;bag&#20540;&#22312;&#19968;&#31471;, &#21333;&#29420;&#20540;(&#38750;&#38598;&#21512;)&#22312;&#21478;&#22806;&#19968;&#31471;
                            </p></dd><dt><span class="term">&#22810;&#23545;&#22810;&#65288;many-to-many&#65289;</span></dt><dd><p>
				        &#20004;&#31471;&#37117;&#26159;set&#25110;bag&#20540;
                            </p></dd></dl></div><p>
            
            </p><p>
                &#35201;&#24314;&#31435;&#19968;&#20010;&#21452;&#21521;&#30340;&#22810;&#23545;&#22810;&#20851;&#32852;&#65292;&#21482;&#38656;&#35201;&#26144;&#23556;&#20004;&#20010;many-to-many&#20851;&#32852;&#21040;&#21516;&#19968;&#20010;&#25968;&#25454;&#24211;&#34920;&#20013;&#65292;&#24182;&#20877;&#23450;&#20041;&#20854;&#20013;&#30340;&#19968;&#31471;&#20026;<span class="emphasis"><em>inverse</em></span>(&#20351;&#29992;&#21738;&#19968;&#31471;&#35201;&#26681;&#25454;&#20320;&#30340;&#36873;&#25321;&#65292;&#20294;&#23427;&#19981;&#33021;&#26159;&#19968;&#20010;&#32034;&#24341;&#38598;&#21512;)&#12290;
            </p><p>
		&#36825;&#37324;&#26377;&#19968;&#20010;many-to-many&#30340;&#21452;&#21521;&#20851;&#32852;&#30340;&#20363;&#23376;;&#27599;&#19968;&#20010;category&#37117;&#21487;&#20197;&#26377;&#24456;&#22810;items,&#27599;&#19968;&#20010;items&#21487;&#20197;&#23646;&#20110;&#24456;&#22810;categories&#65306;
		</p><pre class="programlisting">&lt;class name="Category"&gt;
    &lt;id name="id" column="CATEGORY_ID"/&gt;
    ...
    &lt;bag name="items" table="CATEGORY_ITEM"&gt;
        &lt;key column="CATEGORY_ID"/&gt;
        &lt;many-to-many class="Item" column="ITEM_ID"/&gt;
    &lt;/bag&gt;
&lt;/class&gt;

&lt;class name="Item"&gt;
    &lt;id name="id" column="CATEGORY_ID"/&gt;
    ...

    &lt;!-- inverse end --&gt;
    &lt;bag name="categories" table="CATEGORY_ITEM" inverse="true"&gt;
        &lt;key column="ITEM_ID"/&gt;
        &lt;many-to-many class="Category" column="CATEGORY_ID"/&gt;
    &lt;/bag&gt;
&lt;/class&gt;</pre><p>
                &#22914;&#26524;&#21482;&#23545;&#20851;&#32852;&#30340;&#21453;&#21521;&#31471;&#36827;&#34892;&#20102;&#25913;&#21464;&#65292;&#36825;&#20010;&#25913;&#21464;<span class="emphasis"><em>&#19981;&#20250;</em></span>&#34987;&#25345;&#20037;&#21270;&#12290;
            &#36825;&#34920;&#31034;Hibernate&#20026;&#27599;&#20010;&#21452;&#21521;&#20851;&#32852;&#22312;&#20869;&#23384;&#20013;&#23384;&#22312;&#20004;&#27425;&#34920;&#29616;,&#19968;&#20010;&#20174;A&#36830;&#25509;&#21040;B,&#21478;&#19968;&#20010;&#20174;B&#36830;&#25509;&#21040;A&#12290;&#22914;&#26524;&#20320;&#22238;&#24819;&#19968;&#19979;Java&#23545;&#35937;&#27169;&#22411;&#65292;&#25105;&#20204;&#26159;&#22914;&#20309;&#22312;Java&#20013;&#21019;&#24314;&#22810;&#23545;&#22810;&#20851;&#31995;&#30340;&#65292;&#36825;&#21487;&#20197;&#35753;&#20320;&#26356;&#23481;&#26131;&#29702;&#35299;&#65306;

            </p><pre class="programlisting">
category.getItems().add(item);          // The category now "knows" about the relationship
item.getCategories().add(category);     // The item now "knows" about the relationship

session.persist(item);                   // The relationship won''t be saved!
session.persist(category);               // The relationship will be saved</pre><p>
            &#38750;&#21453;&#21521;&#31471;&#29992;&#20110;&#25226;&#20869;&#23384;&#20013;&#30340;&#34920;&#31034;&#20445;&#23384;&#21040;&#25968;&#25454;&#24211;&#20013;&#12290;
        </p><p>
                &#35201;&#24314;&#31435;&#19968;&#20010;&#19968;&#23545;&#22810;&#30340;&#21452;&#21521;&#20851;&#32852;&#65292;&#20320;&#21487;&#20197;&#36890;&#36807;&#25226;&#19968;&#20010;&#19968;&#23545;&#22810;&#20851;&#32852;&#65292;&#20316;&#20026;&#19968;&#20010;&#22810;&#23545;&#19968;&#20851;&#32852;&#26144;&#23556;&#21040;&#21040;&#21516;&#19968;&#24352;&#34920;&#30340;&#23383;&#27573;&#19978;&#65292;&#24182;&#19988;&#22312;"&#22810;"&#30340;&#37027;&#19968;&#31471;&#23450;&#20041;<tt class="literal">inverse="true"</tt>&#12290;
            </p><pre class="programlisting">&lt;class name="Parent"&gt;
    &lt;id name="id" column="parent_id"/&gt;
    ....
    &lt;set name="children" inverse="true"&gt;
        &lt;key column="parent_id"/&gt;
        &lt;one-to-many class="Child"/&gt;
    &lt;/set&gt;
&lt;/class&gt;

&lt;class name="Child"&gt;
    &lt;id name="id" column="child_id"/&gt;
    ....
    &lt;many-to-one name="parent" 
        class="Parent" 
        column="parent_id"
        not-null="true"/&gt;
&lt;/class&gt;</pre><p>
                &#22312;&#8220;&#19968;&#8221;&#36825;&#19968;&#31471;&#23450;&#20041;<tt class="literal">inverse="true"</tt>&#19981;&#20250;&#24433;&#21709;&#32423;&#32852;&#25805;&#20316;&#65292;&#20108;&#32773;&#26159;&#27491;&#20132;&#30340;&#27010;&#24565;&#65281;
            </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="collections-indexedbidirectional"></a>6.3.3.&nbsp;&#21452;&#21521;&#20851;&#32852;&#65292;&#28041;&#21450;&#26377;&#24207;&#38598;&#21512;&#31867;</h3></div></div><div></div></div><p>
            &#23545;&#20110;&#26377;&#19968;&#31471;&#26159;<tt class="literal">&lt;list&gt;</tt>&#25110;&#32773;<tt class="literal">&lt;map&gt;</tt>&#30340;&#21452;&#21521;&#20851;&#32852;&#65292;&#38656;&#35201;&#21152;&#20197;&#29305;&#21035;&#32771;&#34385;&#12290;&#20551;&#33509;&#23376;&#31867;&#20013;&#30340;&#19968;&#20010;&#23646;&#24615;&#26144;&#23556;&#21040;&#32034;&#24341;&#23383;&#27573;&#65292;&#27809;&#38382;&#39064;&#65292;&#25105;&#20204;&#20173;&#28982;&#21487;&#20197;&#22312;&#38598;&#21512;&#31867;&#26144;&#23556;&#19978;&#20351;&#29992;<tt class="literal">inverse="true"</tt>&#65306;
        </p><pre class="programlisting">&lt;class name="Parent"&gt;
    &lt;id name="id" column="parent_id"/&gt;
    ....
    &lt;map name="children" inverse="true"&gt;
        &lt;key column="parent_id"/&gt;
        &lt;map-key column="name" 
            type="string"/&gt;
        &lt;one-to-many class="Child"/&gt;
    &lt;/map&gt;
&lt;/class&gt;

&lt;class name="Child"&gt;
    &lt;id name="id" column="child_id"/&gt;
    ....
    &lt;property name="name" 
        not-null="true"/&gt;
    &lt;many-to-one name="parent" 
        class="Parent" 
        column="parent_id"
        not-null="true"/&gt;
&lt;/class&gt;</pre><p>
            &#20294;&#26159;&#65292;&#20551;&#33509;&#23376;&#31867;&#20013;&#27809;&#26377;&#36825;&#26679;&#30340;&#23646;&#24615;&#23384;&#22312;&#65292;&#25105;&#20204;&#19981;&#33021;&#35748;&#20026;&#36825;&#20010;&#20851;&#32852;&#26159;&#30495;&#27491;&#30340;&#21452;&#21521;&#20851;&#32852;&#65288;&#20449;&#24687;&#19981;&#23545;&#31216;&#65292;&#22312;&#20851;&#32852;&#30340;&#19968;&#31471;&#26377;&#19968;&#20123;&#21478;&#22806;&#19968;&#31471;&#27809;&#26377;&#30340;&#20449;&#24687;&#65289;&#12290;&#22312;&#36825;&#31181;&#24773;&#20917;&#19979;&#65292;&#25105;&#20204;&#19981;&#33021;&#20351;&#29992;<tt class="literal">inverse="true"</tt>&#12290;&#25105;&#20204;&#38656;&#35201;&#36825;&#26679;&#29992;&#65306;
        </p><pre class="programlisting">&lt;class name="Parent"&gt;
    &lt;id name="id" column="parent_id"/&gt;
    ....
    &lt;map name="children"&gt;
        &lt;key column="parent_id"
            not-null="true"/&gt;
        &lt;map-key column="name" 
            type="string"/&gt;
        &lt;one-to-many class="Child"/&gt;
    &lt;/map&gt;
&lt;/class&gt;

&lt;class name="Child"&gt;
    &lt;id name="id" column="child_id"/&gt;
    ....
    &lt;many-to-one name="parent" 
        class="Parent" 
        column="parent_id"
        insert="false"
        update="false"
        not-null="true"/&gt;
&lt;/class&gt;</pre><p>
           &#27880;&#24847;&#22312;&#36825;&#20010;&#26144;&#23556;&#20013;&#65292;&#20851;&#32852;&#20013;&#38598;&#21512;&#31867;"&#20540;"&#19968;&#31471;&#36127;&#36131;&#26469;&#26356;&#26032;&#22806;&#38190;.TODO: Does this really result in some unnecessary update statements?
       </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="collections-ternary"></a>6.3.4.&nbsp;&#19977;&#37325;&#20851;&#32852;&#65288;Ternary associations&#65289;</h3></div></div><div></div></div><p>
            	&#26377;&#19977;&#31181;&#21487;&#33021;&#30340;&#36884;&#24452;&#26469;&#26144;&#23556;&#19968;&#20010;&#19977;&#37325;&#20851;&#32852;&#12290;&#31532;&#19968;&#31181;&#26159;&#20351;&#29992;&#19968;&#20010;<tt class="literal">Map</tt>&#65292;&#25226;&#19968;&#20010;&#20851;&#32852;&#20316;&#20026;&#20854;&#32034;&#24341;&#65306;
            </p><pre class="programlisting">&lt;map name="contracts"&gt;
    &lt;key column="employer_id" not-null="true"/&gt;
    &lt;map-key-many-to-many column="employee_id" class="Employee"/&gt;
    &lt;one-to-many class="Contract"/&gt;
&lt;/map&gt;</pre><pre class="programlisting">&lt;map name="connections"&gt;
    &lt;key column="incoming_node_id"/&gt;
    &lt;map-key-many-to-many column="outgoing_node_id" class="Node"/&gt;
    &lt;many-to-many column="connection_id" class="Connection"/&gt;
&lt;/map&gt;</pre><p>
        &#31532;&#20108;&#31181;&#26041;&#27861;&#26159;&#31616;&#21333;&#30340;&#25226;&#20851;&#32852;&#37325;&#26032;&#24314;&#27169;&#20026;&#19968;&#20010;&#23454;&#20307;&#31867;&#12290;&#36825;&#20351;&#25105;&#20204;&#26368;&#32463;&#24120;&#20351;&#29992;&#30340;&#26041;&#27861;&#12290;
        </p><p>
        &#26368;&#21518;&#19968;&#31181;&#36873;&#25321;&#26159;&#20351;&#29992;&#22797;&#21512;&#20803;&#32032;&#65292;&#25105;&#20204;&#20250;&#22312;&#21518;&#38754;&#35752;&#35770;
        </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="collections-idbag"></a>6.3.5.&nbsp;<tt class="literal">&#20351;&#29992;&lt;idbag&gt;</tt></h3></div></div><div></div></div><p>
                &#22914;&#26524;&#20320;&#23436;&#20840;&#20449;&#22857;&#25105;&#20204;&#23545;&#20110;&#8220;&#32852;&#21512;&#20027;&#38190;&#65288;composite keys&#65289;&#26159;&#20010;&#22351;&#19996;&#35199;&#8221;&#65292;&#21644;&#8220;&#23454;&#20307;&#24212;&#35813;&#20351;&#29992;&#65288;&#26080;&#26426;&#30340;&#65289;&#33258;&#24049;&#29983;&#25104;&#30340;&#20195;&#29992;&#26631;&#35782;&#31526;&#65288;surrogate keys&#65289;&#8221;&#30340;&#35266;&#28857;&#65292;&#20063;&#35768;&#20320;&#20250;&#24863;&#21040;&#26377;&#19968;&#20123;&#22855;&#24618;&#65292;&#25105;&#20204;&#30446;&#21069;&#20026;&#27490;&#23637;&#31034;&#30340;&#22810;&#23545;&#22810;&#20851;&#32852;&#21644;&#20540;&#38598;&#21512;&#37117;&#26159;&#26144;&#23556;&#25104;&#20026;&#24102;&#26377;&#32852;&#21512;&#20027;&#38190;&#30340;&#34920;&#30340;&#65281;&#29616;&#22312;&#65292;&#36825;&#19968;&#28857;&#38750;&#24120;&#20540;&#24471;&#20105;&#36777;&#65307;&#30475;&#19978;&#21435;&#19968;&#20010;&#21333;&#32431;&#30340;&#20851;&#32852;&#34920;&#24182;&#19981;&#33021;&#20174;&#20195;&#29992;&#26631;&#35782;&#31526;&#20013;&#33719;&#24471;&#20160;&#20040;&#22909;&#22788;&#65288;&#34429;&#28982;&#20351;&#29992;&#32452;&#21512;&#20540;&#30340;&#38598;&#21512;<span class="emphasis"><em>&#21487;&#33021;</em></span>&#20250;&#33719;&#24471;&#19968;&#28857;&#22909;&#22788;&#65289;&#12290;&#19981;&#36807;&#65292;Hibernate&#25552;&#20379;&#20102;&#19968;&#20010;&#65288;&#19968;&#28857;&#28857;&#35797;&#39564;&#24615;&#36136;&#30340;&#65289;&#21151;&#33021;&#65292;&#35753;&#20320;&#25226;&#22810;&#23545;&#22810;&#20851;&#32852;&#21644;&#20540;&#38598;&#21512;&#24212;&#24471;&#21040;&#19968;&#20010;&#20351;&#29992;&#20195;&#29992;&#26631;&#35782;&#31526;&#30340;&#34920;&#21435;&#12290;
            </p><p>
                <tt class="literal">&lt;idbag&gt;</tt> &#23646;&#24615;&#35753;&#20320;&#20351;&#29992;bag&#35821;&#20041;&#26469;&#26144;&#23556;&#19968;&#20010;<tt class="literal">List</tt> (&#25110;<tt class="literal">Collection</tt>)&#12290;
            </p><pre class="programlisting">&lt;idbag name="lovers" table="LOVERS"&gt;
    &lt;collection-id column="ID" type="long"&gt;
        &lt;generator class="sequence"/&gt;
    &lt;/collection-id&gt;
    &lt;key column="PERSON1"/&gt;
    &lt;many-to-many column="PERSON2" class="Person" fetch="join"/&gt;
&lt;/idbag&gt;</pre><p>
                &#20320;&#21487;&#20197;&#29702;&#35299;&#65292;<tt class="literal">&lt;idbag&gt;</tt>&#20154;&#24037;&#30340;id&#29983;&#25104;&#22120;&#65292;&#23601;&#22909;&#20687;&#26159;&#23454;&#20307;&#31867;&#19968;&#26679;&#65281;&#38598;&#21512;&#30340;&#27599;&#19968;&#34892;&#37117;&#26377;&#19968;&#20010;&#19981;&#21516;&#30340;&#20154;&#36896;&#20851;&#38190;&#23383;&#12290;&#20294;&#26159;&#65292;Hibernate&#27809;&#26377;&#25552;&#20379;&#20219;&#20309;&#26426;&#21046;&#26469;&#35753;&#20320;&#21462;&#24471;&#26576;&#20010;&#29305;&#23450;&#34892;&#30340;&#20154;&#36896;&#20851;&#38190;&#23383;&#12290;
            </p><p>
                &#27880;&#24847;<tt class="literal">&lt;idbag&gt;</tt>&#30340;&#26356;&#26032;&#24615;&#33021;&#35201;&#27604;&#26222;&#36890;&#30340;<tt class="literal">&lt;bag&gt;</tt>&#39640;&#24471;&#22810;&#65281;Hibernate&#21487;&#20197;&#26377;&#25928;&#30340;&#23450;&#20301;&#21040;&#19981;&#21516;&#30340;&#34892;&#65292;&#20998;&#21035;&#36827;&#34892;&#26356;&#26032;&#25110;&#21024;&#38500;&#24037;&#20316;&#65292;&#23601;&#22914;&#21516;&#22788;&#29702;&#19968;&#20010;list, map&#25110;&#32773;set&#19968;&#26679;&#12290;
                
            </p><p>
                &#22312;&#30446;&#21069;&#30340;&#23454;&#29616;&#20013;&#65292;&#36824;&#19981;&#25903;&#25345;&#20351;&#29992;<tt class="literal">identity</tt>&#26631;&#35782;&#31526;&#29983;&#25104;&#22120;&#31574;&#30053;&#26469;&#29983;&#25104;<tt class="literal">&lt;idbag&gt;</tt>&#38598;&#21512;&#30340;&#26631;&#35782;&#31526;&#12290;
            </p></div></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="collections-example"></a>6.4.&nbsp;&#38598;&#21512;&#20363;&#23376;&#65288;Collection example&#65289;</h2></div></div><div></div></div><p>
                &#22312;&#21069;&#38754;&#30340;&#20960;&#20010;&#31456;&#33410;&#30340;&#30830;&#38750;&#24120;&#20196;&#20154;&#36855;&#24785;&#12290; &#22240;&#27492;&#35753;&#25105;&#20204;&#26469;&#30475;&#19968;&#20010;&#20363;&#23376;&#12290;&#36825;&#20010;&#31867;&#65306;
            </p><pre class="programlisting">package eg;
import java.util.Set;

public class Parent {
    private long id;
    private Set children;

    public long getId() { return id; }
    private void setId(long id) { this.id=id; }

    private Set getChildren() { return children; }
    private void setChildren(Set children) { this.children=children; }

    ....
    ....
}</pre><p>
                &#36825;&#20010;&#31867;&#26377;&#19968;&#20010;<tt class="literal">Child</tt>&#30340;&#23454;&#20363;&#38598;&#21512;&#12290;&#22914;&#26524;&#27599;&#19968;&#20010;&#23376;&#23454;&#20363;&#33267;&#22810;&#26377;&#19968;&#20010;&#29238;&#23454;&#20363;, &#37027;&#20040;&#26368;&#33258;&#28982;&#30340;&#26144;&#23556;&#26159;&#19968;&#20010;one-to-many&#30340;&#20851;&#32852;&#20851;&#31995;&#65306;
            </p><pre class="programlisting">&lt;hibernate-mapping&gt;

    &lt;class name="Parent"&gt;
        &lt;id name="id"&gt;
            &lt;generator class="sequence"/&gt;
        &lt;/id&gt;
        &lt;set name="children"&gt;
            &lt;key column="parent_id"/&gt;
            &lt;one-to-many class="Child"/&gt;
        &lt;/set&gt;
    &lt;/class&gt;

    &lt;class name="Child"&gt;
        &lt;id name="id"&gt;
            &lt;generator class="sequence"/&gt;
        &lt;/id&gt;
        &lt;property name="name"/&gt;
    &lt;/class&gt;

&lt;/hibernate-mapping&gt;</pre><p>
                &#22312;&#20197;&#19979;&#30340;&#34920;&#23450;&#20041;&#20013;&#21453;&#24212;&#20102;&#36825;&#20010;&#26144;&#23556;&#20851;&#31995;&#65306;
            </p><pre class="programlisting">create table parent ( id bigint not null primary key )
create table child ( id bigint not null primary key, name varchar(255), parent_id bigint )
alter table child add constraint childfk0 (parent_id) references parent</pre><p>
                &#22914;&#26524;&#29238;&#20146;&#26159;<span class="emphasis"><em>&#24517;&#39035;</em></span>&#30340;, &#37027;&#20040;&#23601;&#21487;&#20197;&#20351;&#29992;&#21452;&#21521;one-to-many&#30340;&#20851;&#32852;&#20102;&#65306;
            </p><pre class="programlisting">&lt;hibernate-mapping&gt;

    &lt;class name="Parent"&gt;
        &lt;id name="id"&gt;
            &lt;generator class="sequence"/&gt;
        &lt;/id&gt;
        &lt;set name="children" inverse="true"&gt;
            &lt;key column="parent_id"/&gt;
            &lt;one-to-many class="Child"/&gt;
        &lt;/set&gt;
    &lt;/class&gt;

    &lt;class name="Child"&gt;
        &lt;id name="id"&gt;
            &lt;generator class="sequence"/&gt;
        &lt;/id&gt;
        &lt;property name="name"/&gt;
        &lt;many-to-one name="parent" class="Parent" column="parent_id" not-null="true"/&gt;
    &lt;/class&gt;

&lt;/hibernate-mapping&gt;</pre><p>
                &#35831;&#27880;&#24847;<tt class="literal">NOT NULL</tt>&#30340;&#32422;&#26463;:                
            </p><pre class="programlisting">create table parent ( id bigint not null primary key )
create table child ( id bigint not null
                     primary key,
                     name varchar(255),
                     parent_id bigint not null )
alter table child add constraint childfk0 (parent_id) references parent</pre><p>
            &#21478;&#22806;&#65292;&#22914;&#26524;&#20320;&#32477;&#23545;&#22362;&#25345;&#36825;&#20010;&#20851;&#32852;&#24212;&#35813;&#26159;&#21333;&#21521;&#30340;&#65292;&#20320;&#21487;&#20197;&#23545;<tt class="literal">&lt;key&gt;</tt>&#26144;&#23556;&#22768;&#26126;<tt class="literal">NOT NULL</tt>&#32422;&#26463;&#65306;
        </p><pre class="programlisting">&lt;hibernate-mapping&gt;

    &lt;class name="Parent"&gt;
        &lt;id name="id"&gt;
            &lt;generator class="sequence"/&gt;
        &lt;/id&gt;
        &lt;set name="children"&gt;
            &lt;key column="parent_id" not-null="true"/&gt;
            &lt;one-to-many class="Child"/&gt;
        &lt;/set&gt;
    &lt;/class&gt;

    &lt;class name="Child"&gt;
        &lt;id name="id"&gt;
            &lt;generator class="sequence"/&gt;
        &lt;/id&gt;
        &lt;property name="name"/&gt;
    &lt;/class&gt;

&lt;/hibernate-mapping&gt;</pre><p>
                &#21478;&#22806;&#19968;&#26041;&#38754;,&#22914;&#26524;&#19968;&#20010;&#23376;&#23454;&#20363;&#21487;&#33021;&#26377;&#22810;&#20010;&#29238;&#23454;&#20363;, &#37027;&#20040;&#23601;&#24212;&#35813;&#20351;&#29992;many-to-many&#20851;&#32852;&#65306;
            </p><pre class="programlisting">&lt;hibernate-mapping&gt;

    &lt;class name="Parent"&gt;
        &lt;id name="id"&gt;
            &lt;generator class="sequence"/&gt;
        &lt;/id&gt;
        &lt;set name="children" table="childset"&gt;
            &lt;key column="parent_id"/&gt;
            &lt;many-to-many class="Child" column="child_id"/&gt;
        &lt;/set&gt;
    &lt;/class&gt;

    &lt;class name="Child"&gt;
        &lt;id name="id"&gt;
            &lt;generator class="sequence"/&gt;
        &lt;/id&gt;
        &lt;property name="name"/&gt;
    &lt;/class&gt;

&lt;/hibernate-mapping&gt;</pre><p>
                &#34920;&#23450;&#20041;&#65306;
            </p><pre class="programlisting">create table parent ( id bigint not null primary key )
create table child ( id bigint not null primary key, name varchar(255) )
create table childset ( parent_id bigint not null,
                        child_id bigint not null,
                        primary key ( parent_id, child_id ) )
alter table childset add constraint childsetfk0 (parent_id) references parent
alter table childset add constraint childsetfk1 (child_id) references child</pre><p>
		 &#26356;&#22810;&#30340;&#20363;&#23376;,&#20197;&#21450;&#19968;&#20010;&#23436;&#25972;&#30340;&#29238;/&#23376;&#20851;&#31995;&#26144;&#23556;&#30340;&#25490;&#32451;,&#35831;&#21442;&#38405;<a href="example-parentchild.html" title="&#31532;&nbsp;21&nbsp;&#31456;&nbsp;&#31034;&#20363;&#65306;&#29238;&#23376;&#20851;&#31995;(Parent Child Relationships)">&#31532;&nbsp;21&nbsp;&#31456; <i>&#31034;&#20363;&#65306;&#29238;&#23376;&#20851;&#31995;(Parent Child Relationships)</i></a>.
		</p><p>
            &#29978;&#33267;&#21487;&#33021;&#20986;&#29616;&#26356;&#21152;&#22797;&#26434;&#30340;&#20851;&#32852;&#26144;&#23556;,&#25105;&#20204;&#20250;&#22312;&#19979;&#19968;&#31456;&#20013;&#21015;&#20986;&#25152;&#26377;&#21487;&#33021;&#24615;&#12290;
        </p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="mapping.html">&#19978;&#19968;&#39029;</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="index.html">&#19978;&#19968;&#32423;</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="associations.html">&#19979;&#19968;&#39029;</a></td></tr><tr><td width="40%" align="left" valign="top">&#31532;&nbsp;5&nbsp;&#31456;&nbsp;&#23545;&#35937;/&#20851;&#31995;&#25968;&#25454;&#24211;&#26144;&#23556;&#22522;&#30784;(Basic O/R Mapping)&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">&#36215;&#22987;&#39029;</a></td><td width="40%" align="right" valign="top">&nbsp;&#31532;&nbsp;7&nbsp;&#31456;&nbsp;&#20851;&#32852;&#20851;&#31995;&#26144;&#23556;</td></tr></table></div></body></html>