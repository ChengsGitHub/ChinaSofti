<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>&#31532;&nbsp;10&nbsp;&#31456;&nbsp;&#19982;&#23545;&#35937;&#20849;&#20107;</title><link rel="stylesheet" href="../shared/css/html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.65.1"><link rel="home" href="index.html" title="HIBERNATE - &#31526;&#21512;Java&#20064;&#24815;&#30340;&#20851;&#31995;&#25968;&#25454;&#24211;&#25345;&#20037;&#21270;"><link rel="up" href="index.html" title="HIBERNATE - &#31526;&#21512;Java&#20064;&#24815;&#30340;&#20851;&#31995;&#25968;&#25454;&#24211;&#25345;&#20037;&#21270;"><link rel="previous" href="inheritance.html" title="&#31532;&nbsp;9&nbsp;&#31456;&nbsp;&#32487;&#25215;&#26144;&#23556;(Inheritance Mappings)"><link rel="next" href="transactions.html" title="&#31532;&nbsp;11&nbsp;&#31456;&nbsp;&#20107;&#21153;&#21644;&#24182;&#21457;"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">&#31532;&nbsp;10&nbsp;&#31456;&nbsp;&#19982;&#23545;&#35937;&#20849;&#20107;</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="inheritance.html">&#19978;&#19968;&#39029;</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="transactions.html">&#19979;&#19968;&#39029;</a></td></tr></table><hr></div><div class="chapter" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title"><a name="objectstate"></a>&#31532;&nbsp;10&nbsp;&#31456;&nbsp;&#19982;&#23545;&#35937;&#20849;&#20107;</h2></div></div><div></div></div><p>
	    Hibernate&#26159;&#23436;&#25972;&#30340;&#23545;&#35937;/&#20851;&#31995;&#26144;&#23556;&#35299;&#20915;&#26041;&#26696;&#65292;&#23427;&#25552;&#20379;&#20102;&#23545;&#35937;<span class="emphasis"><em>&#29366;&#24577;&#31649;&#29702;(state management)</em></span>&#30340;&#21151;&#33021;&#65292;&#20351;&#24320;&#21457;&#32773;&#19981;&#20877;&#38656;&#35201;&#29702;&#20250;&#24213;&#23618;&#25968;&#25454;&#24211;&#31995;&#32479;&#30340;&#32454;&#33410;&#12290;
		&#20063;&#23601;&#26159;&#35828;&#65292;&#30456;&#23545;&#20110;&#24120;&#35265;&#30340;JDBC/SQL&#25345;&#20037;&#23618;&#26041;&#26696;&#20013;&#38656;&#35201;<tt class="literal">&#31649;&#29702;SQL&#35821;&#21477;</tt>&#65292;Hibernate&#37319;&#29992;&#20102;&#26356;&#33258;&#28982;&#30340;&#38754;&#21521;&#23545;&#35937;&#30340;&#35270;&#35282;&#26469;&#25345;&#20037;&#21270;Java&#24212;&#29992;&#20013;&#30340;&#25968;&#25454;&#12290;
    </p><p>
		&#25442;&#21477;&#35805;&#35828;&#65292;&#20351;&#29992;Hibernate&#30340;&#24320;&#21457;&#32773;&#24212;&#35813;&#24635;&#26159;&#20851;&#27880;&#23545;&#35937;&#30340;<span class="emphasis"><em>&#29366;&#24577;(state)</em></span>&#65292;&#19981;&#24517;&#32771;&#34385;SQL&#35821;&#21477;&#30340;&#25191;&#34892;&#12290;
		&#36825;&#37096;&#20998;&#32454;&#33410;&#24050;&#32463;&#30001;Hibernate&#25484;&#31649;&#22949;&#24403;&#65292;&#21482;&#26377;&#24320;&#21457;&#32773;&#22312;&#36827;&#34892;&#31995;&#32479;&#24615;&#33021;&#35843;&#20248;&#30340;&#26102;&#20505;&#25165;&#38656;&#35201;&#36827;&#34892;&#20102;&#35299;&#12290;
    </p><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="objectstate-overview"></a>10.1.&nbsp;Hibernate&#23545;&#35937;&#29366;&#24577;(object states)</h2></div></div><div></div></div><p>
            Hibernate&#23450;&#20041;&#24182;&#25903;&#25345;&#19979;&#21015;&#23545;&#35937;&#29366;&#24577;(state):
        </p><div class="itemizedlist"><ul type="disc"><li><p>
                    <span class="emphasis"><em>&#30636;&#26102;(Transient)</em></span> - &#30001;<tt class="literal">new</tt>&#25805;&#20316;&#31526;&#21019;&#24314;&#65292;&#19988;&#23578;&#26410;&#19982;Hibernate <tt class="literal">Session</tt>
					&#20851;&#32852;&#30340;&#23545;&#35937;&#34987;&#35748;&#23450;&#20026;&#30636;&#26102;(Transient)&#30340;&#12290;&#30636;&#26102;(Transient)&#23545;&#35937;&#19981;&#20250;&#34987;&#25345;&#20037;&#21270;&#21040;&#25968;&#25454;&#24211;&#20013;&#65292;&#20063;&#19981;&#20250;&#34987;&#36171;&#20104;&#25345;&#20037;&#21270;&#26631;&#35782;(identifier)&#12290;
					&#22914;&#26524;&#30636;&#26102;(Transient)&#23545;&#35937;&#22312;&#31243;&#24207;&#20013;&#27809;&#26377;&#34987;&#24341;&#29992;&#65292;&#23427;&#20250;&#34987;&#22403;&#22334;&#22238;&#25910;&#22120;(garbage collector)&#38144;&#27585;&#12290;
					&#20351;&#29992;Hibernate <tt class="literal">Session</tt>&#21487;&#20197;&#23558;&#20854;&#21464;&#20026;&#25345;&#20037;(Persistent)&#29366;&#24577;&#12290;(Hibernate&#20250;&#33258;&#21160;&#25191;&#34892;&#24517;&#35201;&#30340;SQL&#35821;&#21477;)
                </p></li><li><p>
                    <span class="emphasis"><em>&#25345;&#20037;(Persistent)</em></span> - &#25345;&#20037;(Persistent)&#30340;&#23454;&#20363;&#22312;&#25968;&#25454;&#24211;&#20013;&#26377;&#23545;&#24212;&#30340;&#35760;&#24405;&#65292;&#24182;&#25317;&#26377;&#19968;&#20010;&#25345;&#20037;&#21270;&#26631;&#35782;(identifier)&#12290;
					&#25345;&#20037;(Persistent)&#30340;&#23454;&#20363;&#21487;&#33021;&#26159;&#21018;&#34987;&#20445;&#23384;&#30340;&#65292;&#25110;&#21018;&#34987;&#21152;&#36733;&#30340;&#65292;&#26080;&#35770;&#21738;&#19968;&#31181;&#65292;&#25353;&#23450;&#20041;&#65292;&#23427;&#23384;&#22312;&#20110;&#30456;&#20851;&#32852;&#30340;<tt class="literal">Session</tt>&#20316;&#29992;&#33539;&#22260;&#20869;&#12290;
					Hibernate&#20250;&#26816;&#27979;&#21040;&#22788;&#20110;&#25345;&#20037;(Persistent)&#29366;&#24577;&#30340;&#23545;&#35937;&#30340;&#20219;&#20309;&#25913;&#21160;&#65292;&#22312;&#24403;&#21069;&#25805;&#20316;&#21333;&#20803;(unit of work)&#25191;&#34892;&#23436;&#27605;&#26102;&#23558;&#23545;&#35937;&#25968;&#25454;(state)&#19982;&#25968;&#25454;&#24211;&#21516;&#27493;(synchronize)&#12290;
					&#24320;&#21457;&#32773;&#19981;&#38656;&#35201;&#25163;&#21160;&#25191;&#34892;<tt class="literal">UPDATE</tt>&#12290;&#23558;&#23545;&#35937;&#20174;&#25345;&#20037;(Persistent)&#29366;&#24577;&#21464;&#25104;&#30636;&#26102;(Transient)&#29366;&#24577;&#21516;&#26679;&#20063;&#19981;&#38656;&#35201;&#25163;&#21160;&#25191;&#34892;<tt class="literal">DELETE</tt>&#35821;&#21477;&#12290;
                </p></li><li><p>
                    <span class="emphasis"><em>&#33073;&#31649;(Detached)</em></span> - &#19982;&#25345;&#20037;(Persistent)&#23545;&#35937;&#20851;&#32852;&#30340;<tt class="literal">Session</tt>&#34987;&#20851;&#38381;&#21518;&#65292;&#23545;&#35937;&#23601;&#21464;&#20026;&#33073;&#31649;(Detached)&#30340;&#12290;
					&#23545;&#33073;&#31649;(Detached)&#23545;&#35937;&#30340;&#24341;&#29992;&#20381;&#28982;&#26377;&#25928;&#65292;&#23545;&#35937;&#21487;&#32487;&#32493;&#34987;&#20462;&#25913;&#12290;&#33073;&#31649;(Detached)&#23545;&#35937;&#22914;&#26524;&#37325;&#26032;&#20851;&#32852;&#21040;&#26576;&#20010;&#26032;&#30340;<tt class="literal">Session</tt>&#19978;&#65292;
					&#20250;&#20877;&#27425;&#36716;&#21464;&#20026;&#25345;&#20037;(Persistent)&#30340;(&#22312;Detached&#20854;&#38388;&#30340;&#25913;&#21160;&#23558;&#34987;&#25345;&#20037;&#21270;&#21040;&#25968;&#25454;&#24211;)&#12290;
                	&#36825;&#20010;&#21151;&#33021;&#20351;&#24471;&#19968;&#31181;&#32534;&#31243;&#27169;&#22411;&#65292;&#21363;&#20013;&#38388;&#20250;&#32473;&#29992;&#25143;&#24605;&#32771;&#26102;&#38388;(user think-time)&#30340;&#38271;&#26102;&#38388;&#36816;&#34892;&#30340;&#25805;&#20316;&#21333;&#20803;(unit of work)&#30340;&#32534;&#31243;&#27169;&#22411;&#25104;&#20026;&#21487;&#33021;&#12290;
                	&#25105;&#20204;&#31216;&#20043;&#20026;<span class="emphasis"><em>&#24212;&#29992;&#31243;&#24207;&#20107;&#21153;</em></span>&#65292;&#21363;&#20174;&#29992;&#25143;&#35266;&#28857;&#30475;&#26159;&#19968;&#20010;&#25805;&#20316;&#21333;&#20803;(unit of work)&#12290;
                </p></li></ul></div><p>
			&#25509;&#19979;&#26469;&#25105;&#20204;&#26469;&#32454;&#33268;&#30340;&#35752;&#35770;&#19979;&#29366;&#24577;(states)&#21450;&#29366;&#24577;&#38388;&#30340;&#36716;&#25442;(state transitions)&#65288;&#20197;&#21450;&#35302;&#21457;&#29366;&#24577;&#36716;&#25442;&#30340;Hibernate&#26041;&#27861;&#65289;&#12290;
        </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="objectstate-makingpersistent"></a>10.2.&nbsp;&#20351;&#23545;&#35937;&#25345;&#20037;&#21270;</h2></div></div><div></div></div><p>
			Hibernate&#35748;&#20026;&#25345;&#20037;&#21270;&#31867;(persistent class)&#26032;&#23454;&#20363;&#21270;&#30340;&#23545;&#35937;&#26159;<span class="emphasis"><em>&#30636;&#26102;(Transient)</em></span>&#30340;&#12290;
			&#25105;&#20204;&#21487;&#36890;&#36807;&#23558;&#30636;&#26102;(Transient)&#23545;&#35937;&#19982;session&#20851;&#32852;&#32780;&#25226;&#23427;&#21464;&#20026;<span class="emphasis"><em>&#25345;&#20037;(Persistent)</em></span>&#30340;&#12290;
        </p><pre class="programlisting">DomesticCat fritz = new DomesticCat();
fritz.setColor(Color.GINGER);
fritz.setSex('M');
fritz.setName("Fritz");
Long generatedId = (Long) sess.save(fritz);</pre><p>
			&#22914;&#26524;<tt class="literal">Cat</tt>&#30340;&#25345;&#20037;&#21270;&#26631;&#35782;(identifier)&#26159;<tt class="literal">generated</tt>&#31867;&#22411;&#30340;&#65292;
			&#37027;&#20040;&#35813;&#26631;&#35782;(identifier)&#20250;&#33258;&#21160;&#22312;<tt class="literal">save()</tt>&#34987;&#35843;&#29992;&#26102;&#20135;&#29983;&#24182;&#20998;&#37197;&#32473;<tt class="literal">cat</tt>&#12290;
			&#22914;&#26524;<tt class="literal">Cat</tt>&#30340;&#25345;&#20037;&#21270;&#26631;&#35782;(identifier)&#26159;<tt class="literal">assigned</tt>&#31867;&#22411;&#30340;&#65292;&#25110;&#26159;&#19968;&#20010;&#22797;&#21512;&#20027;&#38190;(composite key)&#65292;
			&#37027;&#20040;&#35813;&#26631;&#35782;(identifier)&#24212;&#24403;&#22312;&#35843;&#29992;<tt class="literal">save()</tt>&#20043;&#21069;&#25163;&#21160;&#36171;&#20104;&#32473;<tt class="literal">cat</tt>&#12290;
			&#20320;&#20063;&#21487;&#20197;&#25353;&#29031;EJB3 early draft&#20013;&#23450;&#20041;&#30340;&#35821;&#20041;&#65292;&#20351;&#29992;<tt class="literal">persist()</tt>&#26367;&#20195;<tt class="literal">save()</tt>&#12290;
        </p><p>
            &#27492;&#22806;&#65292;&#20320;&#21487;&#20197;&#29992;&#19968;&#20010;&#37325;&#36733;&#29256;&#26412;&#30340;<tt class="literal">save()</tt>&#26041;&#27861;&#12290;
        </p><pre class="programlisting">DomesticCat pk = new DomesticCat();
pk.setColor(Color.TABBY);
pk.setSex('F');
pk.setName("PK");
pk.setKittens( new HashSet() );
pk.addKitten(fritz);
sess.save( pk, new Long(1234) );</pre><p>
			&#22914;&#26524;&#20320;&#25345;&#20037;&#21270;&#30340;&#23545;&#35937;&#26377;&#20851;&#32852;&#30340;&#23545;&#35937;(associated objects)&#65288;&#20363;&#22914;&#19978;&#20363;&#20013;&#30340;<tt class="literal">kittens</tt>&#38598;&#21512;&#65289;
  			&#37027;&#20040;&#23545;&#36825;&#20123;&#23545;&#35937;&#65288;&#35793;&#27880;&#65306;pk&#21644;kittens&#65289;&#36827;&#34892;&#25345;&#20037;&#21270;&#30340;&#39034;&#24207;&#26159;&#20219;&#24847;&#30340;&#65288;&#20063;&#23601;&#26159;&#35828;&#21487;&#20197;&#20808;&#23545;kittens&#36827;&#34892;&#25345;&#20037;&#21270;&#20063;&#21487;&#20197;&#20808;&#23545;pk&#36827;&#34892;&#25345;&#20037;&#21270;&#65289;&#65292;
  			&#38500;&#38750;&#20320;&#22312;&#22806;&#38190;&#21015;&#19978;&#26377;<tt class="literal">NOT NULL</tt>&#32422;&#26463;&#12290;
            Hibernate&#19981;&#20250;&#36829;&#21453;&#22806;&#38190;&#32422;&#26463;&#65292;&#20294;&#26159;&#22914;&#26524;&#20320;&#29992;&#38169;&#35823;&#30340;&#39034;&#24207;&#25345;&#20037;&#21270;&#23545;&#35937;&#65288;&#35793;&#27880;&#65306;&#22312;pk&#25345;&#20037;&#21270;&#20043;&#21069;&#25345;&#20037;&#21270;kitten&#65289;&#65292;&#37027;&#20040;&#21487;&#33021;&#20250;&#36829;&#21453;<tt class="literal">NOT NULL</tt>&#32422;&#26463;&#12290;
        </p><p>
			&#36890;&#24120;&#20320;&#19981;&#20250;&#20026;&#36825;&#20123;&#32454;&#33410;&#28902;&#24515;&#65292;&#22240;&#20026;&#20320;&#24456;&#21487;&#33021;&#20250;&#20351;&#29992;Hibernate&#30340;
			<span class="emphasis"><em>&#20256;&#25773;&#24615;&#25345;&#20037;&#21270;(transitive persistence)</em></span>&#21151;&#33021;&#33258;&#21160;&#20445;&#23384;&#30456;&#20851;&#32852;&#37027;&#20123;&#23545;&#35937;&#12290;
			&#36825;&#26679;&#36830;&#36829;&#21453;<tt class="literal">NOT NULL</tt>&#32422;&#26463;&#30340;&#24773;&#20917;&#37117;&#19981;&#20250;&#20986;&#29616;&#20102; - Hibernate&#20250;&#31649;&#22909;&#25152;&#26377;&#30340;&#20107;&#24773;&#12290;
			&#20256;&#25773;&#24615;&#25345;&#20037;&#21270;(transitive persistence)&#23558;&#22312;&#26412;&#31456;&#31245;&#21518;&#35752;&#35770;&#12290;
        </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="objectstate-loading"></a>10.3.&nbsp;&#35013;&#36733;&#23545;&#35937;</h2></div></div><div></div></div><p>
        	&#22914;&#26524;&#20320;&#30693;&#36947;&#26576;&#20010;&#23454;&#20363;&#30340;&#25345;&#20037;&#21270;&#26631;&#35782;(identifier)&#65292;&#20320;&#23601;&#21487;&#20197;&#20351;&#29992;<tt class="literal">Session</tt>&#30340;<tt class="literal">load()</tt>&#26041;&#27861;
        	&#26469;&#33719;&#21462;&#23427;&#12290; <tt class="literal">load()</tt>&#30340;&#21478;&#19968;&#20010;&#21442;&#25968;&#26159;&#25351;&#23450;&#31867;&#30340;.class&#23545;&#35937;&#12290;
        	&#26412;&#26041;&#27861;&#20250;&#21019;&#24314;&#25351;&#23450;&#31867;&#30340;&#25345;&#20037;&#21270;&#23454;&#20363;&#65292;&#24182;&#20174;&#25968;&#25454;&#24211;&#21152;&#36733;&#20854;&#25968;&#25454;(state)&#12290;
        </p><pre class="programlisting">Cat fritz = (Cat) sess.load(Cat.class, generatedId);</pre><pre class="programlisting">// you need to wrap primitive identifiers
long id = 1234;
DomesticCat pk = (DomesticCat) sess.load( DomesticCat.class, new Long(id) );</pre><p>
            &#27492;&#22806;, &#20320;&#21487;&#20197;&#25226;&#25968;&#25454;(state)&#21152;&#36733;&#21040;&#25351;&#23450;&#30340;&#23545;&#35937;&#23454;&#20363;&#19978;&#65288;&#35206;&#30422;&#25481;&#35813;&#23454;&#20363;&#21407;&#26469;&#30340;&#25968;&#25454;&#65289;&#12290;
        </p><pre class="programlisting">Cat cat = new DomesticCat();
// load pk's state into cat
sess.load( cat, new Long(pkId) );
Set kittens = cat.getKittens();</pre><p>
			&#35831;&#27880;&#24847;&#22914;&#26524;&#27809;&#26377;&#21305;&#37197;&#30340;&#25968;&#25454;&#24211;&#35760;&#24405;&#65292;<tt class="literal">load()</tt>&#26041;&#27861;&#21487;&#33021;&#25243;&#20986;&#26080;&#27861;&#24674;&#22797;&#30340;&#24322;&#24120;(unrecoverable exception)&#12290;
			&#22914;&#26524;&#31867;&#30340;&#26144;&#23556;&#20351;&#29992;&#20102;&#20195;&#29702;(proxy)&#65292;<tt class="literal">load()</tt>&#26041;&#27861;&#20250;&#36820;&#22238;&#19968;&#20010;&#26410;&#21021;&#22987;&#21270;&#30340;&#20195;&#29702;&#65292;&#30452;&#21040;&#20320;&#35843;&#29992;&#35813;&#20195;&#29702;&#30340;&#26576;&#26041;&#27861;&#26102;&#25165;&#20250;&#21435;&#35775;&#38382;&#25968;&#25454;&#24211;&#12290;
			&#33509;&#20320;&#24076;&#26395;&#22312;&#26576;&#23545;&#35937;&#20013;&#21019;&#24314;&#19968;&#20010;&#25351;&#21521;&#21478;&#19968;&#20010;&#23545;&#35937;&#30340;&#20851;&#32852;&#65292;&#21448;&#19981;&#24819;&#22312;&#20174;&#25968;&#25454;&#24211;&#20013;&#35013;&#36733;&#35813;&#23545;&#35937;&#26102;&#21516;&#26102;&#35013;&#36733;&#30456;&#20851;&#32852;&#30340;&#37027;&#20010;&#23545;&#35937;&#65292;&#37027;&#20040;&#36825;&#31181;&#25805;&#20316;&#26041;&#24335;&#23601;&#29992;&#24471;&#19978;&#30340;&#20102;&#12290;
			&#22914;&#26524;&#20026;&#30456;&#24212;&#31867;&#26144;&#23556;&#20851;&#31995;&#35774;&#32622;&#20102;<tt class="literal">batch-size</tt>&#65292;
			&#37027;&#20040;&#20351;&#29992;&#36825;&#31181;&#25805;&#20316;&#26041;&#24335;&#20801;&#35768;&#22810;&#20010;&#23545;&#35937;&#34987;&#19968;&#25209;&#35013;&#36733;&#65288;&#22240;&#20026;&#36820;&#22238;&#30340;&#26159;&#20195;&#29702;&#65292;&#26080;&#38656;&#20174;&#25968;&#25454;&#24211;&#20013;&#25235;&#21462;&#25152;&#26377;&#23545;&#35937;&#30340;&#25968;&#25454;&#65289;&#12290;
        </p><p>
       		&#22914;&#26524;&#20320;&#19981;&#30830;&#23450;&#26159;&#21542;&#26377;&#21305;&#37197;&#30340;&#34892;&#23384;&#22312;&#65292;&#24212;&#35813;&#20351;&#29992;<tt class="literal">get()</tt>&#26041;&#27861;&#65292;&#23427;&#20250;&#31435;&#21051;&#35775;&#38382;&#25968;&#25454;&#24211;&#65292;&#22914;&#26524;&#27809;&#26377;&#23545;&#24212;&#30340;&#35760;&#24405;&#65292;&#20250;&#36820;&#22238;null&#12290;
        </p><pre class="programlisting">Cat cat = (Cat) sess.get(Cat.class, id);
if (cat==null) {
    cat = new Cat();
    sess.save(cat, id);
}
return cat;</pre><p>
			&#20320;&#29978;&#33267;&#21487;&#20197;&#36873;&#29992;&#26576;&#20010;<tt class="literal">LockMode</tt>&#65292;&#29992;SQL&#30340;<tt class="literal">SELECT ... FOR UPDATE</tt>&#35013;&#36733;&#23545;&#35937;&#12290;
			&#35831;&#26597;&#38405;API&#25991;&#26723;&#20197;&#33719;&#21462;&#26356;&#22810;&#20449;&#24687;&#12290;
        </p><pre class="programlisting">Cat cat = (Cat) sess.get(Cat.class, id, LockMode.UPGRADE);</pre><p>
              &#27880;&#24847;&#65292;&#20219;&#20309;&#20851;&#32852;&#30340;&#23545;&#35937;&#25110;&#32773;&#21253;&#21547;&#30340;&#38598;&#21512;&#37117;<span class="emphasis"><em>&#19981;&#20250;</em></span>&#34987;&#20197;<tt class="literal">FOR UPDATE</tt>&#26041;&#24335;&#36820;&#22238;&#65292;
 			&#38500;&#38750;&#20320;&#25351;&#23450;&#20102;<tt class="literal">lock</tt>&#25110;&#32773;<tt class="literal">all</tt>&#20316;&#20026;&#20851;&#32852;(association)&#30340;&#32423;&#32852;&#39118;&#26684;(cascade style)&#12290;
        </p><p>
			&#20219;&#20309;&#26102;&#20505;&#37117;&#21487;&#20197;&#20351;&#29992;<tt class="literal">refresh()</tt>&#26041;&#27861;&#24378;&#36843;&#35013;&#36733;&#23545;&#35937;&#21644;&#23427;&#30340;&#38598;&#21512;&#12290;&#22914;&#26524;&#20320;&#20351;&#29992;&#25968;&#25454;&#24211;&#35302;&#21457;&#22120;&#21151;&#33021;&#26469;&#22788;&#29702;&#23545;&#35937;&#30340;&#26576;&#20123;&#23646;&#24615;&#65292;&#36825;&#20010;&#26041;&#27861;&#23601;&#24456;&#26377;&#29992;&#20102;&#12290;
        </p><pre class="programlisting">sess.save(cat);
sess.flush(); //force the SQL INSERT
sess.refresh(cat); //re-read the state (after the trigger executes)</pre><p>
			&#27492;&#22788;&#36890;&#24120;&#20250;&#20986;&#29616;&#19968;&#20010;&#37325;&#35201;&#38382;&#39064;: Hibernate&#20250;&#20174;&#25968;&#25454;&#24211;&#20013;&#35013;&#36733;&#22810;&#23569;&#19996;&#35199;&#65311;&#20250;&#25191;&#34892;&#22810;&#23569;&#26465;&#30456;&#24212;&#30340;SQL<tt class="literal">SELECT</tt>&#35821;&#21477;&#65311;
           	&#36825;&#21462;&#20915;&#20110;<span class="emphasis"><em>&#25235;&#21462;&#31574;&#30053;(fetching strategy)</em></span>&#65292;&#20250;&#22312;<a href="performance.html#performance-fetching" title="19.1.&nbsp;&#xA;			&#25235;&#21462;&#31574;&#30053;(Fetching strategies)&#xA;		">&#31532;&nbsp;19.1&nbsp;&#33410; &#8220;
			&#25235;&#21462;&#31574;&#30053;(Fetching strategies)
		&#8221;</a>&#20013;&#35299;&#37322;&#12290;
        </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="objectstate-querying"></a>10.4.&nbsp;&#26597;&#35810;</h2></div></div><div></div></div><p>
			&#22914;&#26524;&#19981;&#30693;&#36947;&#25152;&#35201;&#23547;&#25214;&#30340;&#23545;&#35937;&#30340;&#25345;&#20037;&#21270;&#26631;&#35782;&#65292;&#37027;&#20040;&#20320;&#38656;&#35201;&#20351;&#29992;&#26597;&#35810;&#12290;Hibernate&#25903;&#25345;&#24378;&#22823;&#19988;&#26131;&#20110;&#20351;&#29992;&#30340;&#38754;&#21521;&#23545;&#35937;&#26597;&#35810;&#35821;&#35328;(HQL)&#12290;
			&#22914;&#26524;&#24076;&#26395;&#36890;&#36807;&#32534;&#31243;&#30340;&#26041;&#24335;&#21019;&#24314;&#26597;&#35810;&#65292;Hibernate&#25552;&#20379;&#20102;&#23436;&#21892;&#30340;&#25353;&#26465;&#20214;(Query By Criteria, QBC)&#20197;&#21450;&#25353;&#26679;&#20363;(Query By Example, QBE)&#36827;&#34892;&#26597;&#35810;&#30340;&#21151;&#33021;&#12290;
			&#20320;&#20063;&#21487;&#20197;&#29992;&#21407;&#29983;SQL(native SQL)&#25551;&#36848;&#26597;&#35810;&#65292;Hibernate&#39069;&#22806;&#25552;&#20379;&#20102;&#23558;&#32467;&#26524;&#38598;(result set)&#36716;&#21270;&#20026;&#23545;&#35937;&#30340;&#25903;&#25345;&#12290;
        </p><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="objectstate-querying-executing"></a>10.4.1.&nbsp;&#25191;&#34892;&#26597;&#35810;</h3></div></div><div></div></div><p>
                HQL&#21644;&#21407;&#29983;SQL(native SQL)&#26597;&#35810;&#35201;&#36890;&#36807;&#20026;<tt class="literal">org.hibernate.Query</tt>&#30340;&#23454;&#20363;&#26469;&#34920;&#36798;&#12290;
				&#36825;&#20010;&#25509;&#21475;&#25552;&#20379;&#20102;&#21442;&#25968;&#32465;&#23450;&#12289;&#32467;&#26524;&#38598;&#22788;&#29702;&#20197;&#21450;&#36816;&#34892;&#23454;&#38469;&#26597;&#35810;&#30340;&#26041;&#27861;&#12290;
				&#20320;&#24635;&#26159;&#21487;&#20197;&#36890;&#36807;&#24403;&#21069;<tt class="literal">Session</tt>&#33719;&#21462;&#19968;&#20010;<tt class="literal">Query</tt>&#23545;&#35937;&#65306;
            </p><pre class="programlisting">List cats = session.createQuery(
    "from Cat as cat where cat.birthdate &lt; ?")
    .setDate(0, date)
    .list();

List mothers = session.createQuery(
    "select mother from Cat as cat join cat.mother as mother where cat.name = ?")
    .setString(0, name)
    .list();

List kittens = session.createQuery(
    "from Cat as cat where cat.mother = ?")
    .setEntity(0, pk)
    .list();

Cat mother = (Cat) session.createQuery(
    "select cat.mother from Cat as cat where cat = ?")
    .setEntity(0, izi)
    .uniqueResult();]]

Query mothersWithKittens = (Cat) session.createQuery(
    "select mother from Cat as mother left join fetch mother.kittens");
Set uniqueMothers = new HashSet(mothersWithKittens.list());</pre><p>
            	&#19968;&#20010;&#26597;&#35810;&#36890;&#24120;&#22312;&#35843;&#29992;<tt class="literal">list()</tt>&#26102;&#34987;&#25191;&#34892;&#65292;&#25191;&#34892;&#32467;&#26524;&#20250;&#23436;&#20840;&#35013;&#36733;&#36827;&#20869;&#23384;&#20013;&#30340;&#19968;&#20010;&#38598;&#21512;(collection)&#12290;
            	&#26597;&#35810;&#36820;&#22238;&#30340;&#23545;&#35937;&#22788;&#20110;&#25345;&#20037;(persistent)&#29366;&#24577;&#12290;&#22914;&#26524;&#20320;&#30693;&#36947;&#30340;&#26597;&#35810;&#21482;&#20250;&#36820;&#22238;&#19968;&#20010;&#23545;&#35937;&#65292;&#21487;&#20351;&#29992;<tt class="literal">list()</tt>&#30340;&#24555;&#25463;&#26041;&#24335;<tt class="literal">uniqueResult()</tt>&#12290;
            	&#27880;&#24847;&#65292;&#20351;&#29992;&#38598;&#21512;&#39044;&#20808;&#25235;&#21462;&#30340;&#26597;&#35810;&#24448;&#24448;&#20250;&#36820;&#22238;&#22810;&#27425;&#26681;&#23545;&#35937;&#65288;&#20182;&#20204;&#30340;&#38598;&#21512;&#31867;&#37117;&#34987;&#21021;&#22987;&#21270;&#20102;&#65289;&#12290;&#20320;&#21487;&#20197;&#36890;&#36807;&#19968;&#20010;&#38598;&#21512;&#26469;&#36807;&#28388;&#36825;&#20123;&#37325;&#22797;&#23545;&#35937;&#12290;    	
            </p><div class="sect3" lang="zh-cn"><div class="titlepage"><div><div><h4 class="title"><a name="objectstate-querying-executing-iterate"></a>10.4.1.1.&nbsp;&#36845;&#20195;&#24335;&#33719;&#21462;&#32467;&#26524;(Iterating results)</h4></div></div><div></div></div><p>
					&#26576;&#20123;&#24773;&#20917;&#19979;&#65292;&#20320;&#21487;&#20197;&#20351;&#29992;<tt class="literal">iterate()</tt>&#26041;&#27861;&#24471;&#21040;&#26356;&#22909;&#30340;&#24615;&#33021;&#12290;
					&#36825;&#36890;&#24120;&#26159;&#20320;&#39044;&#26399;&#36820;&#22238;&#30340;&#32467;&#26524;&#22312;session&#65292;&#25110;&#20108;&#32423;&#32531;&#23384;(second-level cache)&#20013;&#24050;&#32463;&#23384;&#22312;&#26102;&#30340;&#24773;&#20917;&#12290;
					&#22914;&#33509;&#19981;&#28982;&#65292;<tt class="literal">iterate()</tt>&#20250;&#27604;<tt class="literal">list()</tt>&#24930;&#65292;&#32780;&#19988;&#21487;&#33021;&#31616;&#21333;&#26597;&#35810;&#20063;&#38656;&#35201;&#36827;&#34892;&#22810;&#27425;&#25968;&#25454;&#24211;&#35775;&#38382;&#65306;
					<tt class="literal">iterate()</tt>&#20250;&#39318;&#20808;&#20351;&#29992;<span class="emphasis"><em>1</em></span>&#26465;&#35821;&#21477;&#24471;&#21040;&#25152;&#26377;&#23545;&#35937;&#30340;&#25345;&#20037;&#21270;&#26631;&#35782;(identifiers)&#65292;&#20877;&#26681;&#25454;&#25345;&#20037;&#21270;&#26631;&#35782;&#25191;&#34892;<span class="emphasis"><em>n</em></span>&#26465;&#38468;&#21152;&#30340;select&#35821;&#21477;&#23454;&#20363;&#21270;&#23454;&#38469;&#30340;&#23545;&#35937;&#12290;
                </p><pre class="programlisting">// fetch ids
Iterator iter = sess.createQuery("from eg.Qux q order by q.likeliness").iterate();
while ( iter.hasNext() ) {
    Qux qux = (Qux) iter.next();  // fetch the object
    // something we couldnt express in the query
    if ( qux.calculateComplicatedAlgorithm() ) {
        // delete the current instance
        iter.remove();
        // dont need to process the rest
        break;
    }
}</pre></div><div class="sect3" lang="zh-cn"><div class="titlepage"><div><div><h4 class="title"><a name="objectstate-querying-executing-tuples"></a>10.4.1.2.&nbsp;&#36820;&#22238;&#20803;&#32452;(tuples)&#30340;&#26597;&#35810;</h4></div></div><div></div></div><p>
                &#65288;&#35793;&#27880;&#65306;&#20803;&#32452;(tuples)&#25351;&#19968;&#26465;&#32467;&#26524;&#34892;&#21253;&#21547;&#22810;&#20010;&#23545;&#35937;&#65289;
                    Hibernate&#26597;&#35810;&#26377;&#26102;&#36820;&#22238;&#20803;&#32452;(tuples)&#65292;&#27599;&#20010;&#20803;&#32452;(tuples)&#20197;&#25968;&#32452;&#30340;&#24418;&#24335;&#36820;&#22238;:
                </p><pre class="programlisting">Iterator kittensAndMothers = sess.createQuery(
            "select kitten, mother from Cat kitten join kitten.mother mother")
            .list()
            .iterator();

while ( kittensAndMothers.hasNext() ) {
    Object[] tuple = (Object[]) kittensAndMothers.next();
    Cat kitten  = tuple[0];
    Cat mother  = tuple[1];
    ....
}</pre></div><div class="sect3" lang="zh-cn"><div class="titlepage"><div><div><h4 class="title"><a name="objectstate-querying-executing-scalar"></a>10.4.1.3.&nbsp;&#26631;&#37327;(Scalar)&#32467;&#26524;</h4></div></div><div></div></div><p>
					&#26597;&#35810;&#21487;&#22312;<tt class="literal">select</tt>&#20174;&#21477;&#20013;&#25351;&#23450;&#31867;&#30340;&#23646;&#24615;&#65292;&#29978;&#33267;&#21487;&#20197;&#35843;&#29992;SQL&#32479;&#35745;(aggregate)&#20989;&#25968;&#12290;
					&#23646;&#24615;&#25110;&#32479;&#35745;&#32467;&#26524;&#34987;&#35748;&#23450;&#20026;"&#26631;&#37327;(Scalar)"&#30340;&#32467;&#26524;&#65288;&#32780;&#19981;&#26159;&#25345;&#20037;(persistent state)&#30340;&#23454;&#20307;&#65289;&#12290;
                </p><pre class="programlisting">Iterator results = sess.createQuery(
        "select cat.color, min(cat.birthdate), count(cat) from Cat cat " +
        "group by cat.color")
        .list()
        .iterator();
        
while ( results.hasNext() ) {
    Object[] row = (Object[]) results.next();
    Color type = (Color) row[0];
    Date oldest = (Date) row[1];
    Integer count = (Integer) row[2];
    .....
}</pre></div><div class="sect3" lang="zh-cn"><div class="titlepage"><div><div><h4 class="title"><a name="objectstate-querying-executing-parameters"></a>10.4.1.4.&nbsp;&#32465;&#23450;&#21442;&#25968;</h4></div></div><div></div></div><p>
                    &#25509;&#21475;<tt class="literal">Query</tt>&#25552;&#20379;&#20102;&#23545;&#21629;&#21517;&#21442;&#25968;(named parameters)&#12289;JDBC&#39118;&#26684;&#30340;<tt class="literal">&#38382;&#21495;(?)</tt>&#21442;&#25968;&#36827;&#34892;&#32465;&#23450;&#30340;&#26041;&#27861;&#12290;
					<span class="emphasis"><em>&#19981;&#21516;&#20110;JDBC&#65292;Hibernate&#23545;&#21442;&#25968;&#20174;0&#24320;&#22987;&#35745;&#25968;&#12290;</em></span>
                    &#21629;&#21517;&#21442;&#25968;(named parameters)&#22312;&#26597;&#35810;&#23383;&#31526;&#20018;&#20013;&#26159;&#24418;&#22914;<tt class="literal">:name</tt>&#30340;&#26631;&#35782;&#31526;&#12290;
                    &#21629;&#21517;&#21442;&#25968;(named parameters)&#30340;&#20248;&#28857;&#26159;:
                </p><div class="itemizedlist"><ul type="disc" compact><li><p>
                            &#21629;&#21517;&#21442;&#25968;(named parameters)&#19982;&#20854;&#22312;&#26597;&#35810;&#20018;&#20013;&#20986;&#29616;&#30340;&#39034;&#24207;&#26080;&#20851;
                        </p></li><li><p>
                                &#23427;&#20204;&#21487;&#22312;&#21516;&#19968;&#26597;&#35810;&#20018;&#20013;&#22810;&#27425;&#20986;&#29616;
                        </p></li><li><p>
                                &#23427;&#20204;&#26412;&#36523;&#26159;&#33258;&#25105;&#35828;&#26126;&#30340;
                        </p></li></ul></div><pre class="programlisting">//named parameter (preferred)
Query q = sess.createQuery("from DomesticCat cat where cat.name = :name");
q.setString("name", "Fritz");
Iterator cats = q.iterate();</pre><pre class="programlisting">//positional parameter
Query q = sess.createQuery("from DomesticCat cat where cat.name = ?");
q.setString(0, "Izi");
Iterator cats = q.iterate();</pre><pre class="programlisting">//named parameter list
List names = new ArrayList();
names.add("Izi");
names.add("Fritz");
Query q = sess.createQuery("from DomesticCat cat where cat.name in (:namesList)");
q.setParameterList("namesList", names);
List cats = q.list();</pre></div><div class="sect3" lang="zh-cn"><div class="titlepage"><div><div><h4 class="title"><a name="objectstate-querying-executing-pagination"></a>10.4.1.5.&nbsp;&#20998;&#39029;</h4></div></div><div></div></div><p>
                    &#22914;&#26524;&#20320;&#38656;&#35201;&#25351;&#23450;&#32467;&#26524;&#38598;&#30340;&#33539;&#22260;&#65288;&#24076;&#26395;&#36820;&#22238;&#30340;&#26368;&#22823;&#34892;&#25968;/&#25110;&#24320;&#22987;&#30340;&#34892;&#25968;&#65289;&#65292;&#24212;&#35813;&#20351;&#29992;<tt class="literal">Query</tt>&#25509;&#21475;&#25552;&#20379;&#30340;&#26041;&#27861;:
                </p><pre class="programlisting">Query q = sess.createQuery("from DomesticCat cat");
q.setFirstResult(20);
q.setMaxResults(10);
List cats = q.list();</pre><p>
                    Hibernate &#30693;&#36947;&#22914;&#20309;&#23558;&#36825;&#20010;&#26377;&#38480;&#23450;&#26465;&#20214;&#30340;&#26597;&#35810;&#36716;&#25442;&#25104;&#20320;&#30340;&#25968;&#25454;&#24211;&#30340;&#21407;&#29983;SQL(native SQL)&#12290;
                </p></div><div class="sect3" lang="zh-cn"><div class="titlepage"><div><div><h4 class="title"><a name="objectstate-querying-executing-scrolling"></a>10.4.1.6.&nbsp;&#21487;&#28378;&#21160;&#36941;&#21382;(Scrollable iteration)</h4></div></div><div></div></div><p>
					&#22914;&#26524;&#20320;&#30340;JDBC&#39537;&#21160;&#25903;&#25345;&#21487;&#28378;&#21160;&#30340;<tt class="literal">ResuleSet</tt>&#65292;<tt class="literal">Query</tt>&#25509;&#21475;&#21487;&#20197;&#20351;&#29992;<tt class="literal">ScrollableResults</tt>&#65292;&#20801;&#35768;&#20320;&#22312;&#26597;&#35810;&#32467;&#26524;&#20013;&#28789;&#27963;&#28216;&#36208;&#12290;
				</p><pre class="programlisting">Query q = sess.createQuery("select cat.name, cat from DomesticCat cat " +
                            "order by cat.name");
ScrollableResults cats = q.scroll();
if ( cats.first() ) {

    // find the first name on each page of an alphabetical list of cats by name
    firstNamesOfPages = new ArrayList();
    do {
        String name = cats.getString(0);
        firstNamesOfPages.add(name);
    }
    while ( cats.scroll(PAGE_SIZE) );

    // Now get the first page of cats
    pageOfCats = new ArrayList();
    cats.beforeFirst();
    int i=0;
    while( ( PAGE_SIZE &gt; i++ ) &amp;&amp; cats.next() ) pageOfCats.add( cats.get(1) );

}
cats.close()</pre><p>
					&#35831;&#27880;&#24847;&#65292;&#20351;&#29992;&#27492;&#21151;&#33021;&#38656;&#35201;&#20445;&#25345;&#25968;&#25454;&#24211;&#36830;&#25509;&#65288;&#20197;&#21450;&#28216;&#26631;(cursor)&#65289;&#22788;&#20110;&#19968;&#30452;&#25171;&#24320;&#29366;&#24577;&#12290;
					&#22914;&#26524;&#20320;&#38656;&#35201;&#26029;&#24320;&#36830;&#25509;&#20351;&#29992;&#20998;&#39029;&#21151;&#33021;&#65292;&#35831;&#20351;&#29992;<tt class="literal">setMaxResult()</tt>/<tt class="literal">setFirstResult()</tt>
                </p></div><div class="sect3" lang="zh-cn"><div class="titlepage"><div><div><h4 class="title"><a name="objectstate-querying-executing-named"></a>10.4.1.7.&nbsp;&#22806;&#32622;&#21629;&#21517;&#26597;&#35810;(Externalizing named queries)</h4></div></div><div></div></div><p>
					&#20320;&#21487;&#20197;&#22312;&#26144;&#23556;&#25991;&#20214;&#20013;&#23450;&#20041;&#21629;&#21517;&#26597;&#35810;(named queries)&#12290;
					&#65288;&#22914;&#26524;&#20320;&#30340;&#26597;&#35810;&#20018;&#20013;&#21253;&#21547;&#21487;&#33021;&#34987;&#35299;&#37322;&#20026;XML&#26631;&#35760;(markup)&#30340;&#23383;&#31526;&#65292;&#21035;&#24536;&#20102;&#29992;<tt class="literal">CDATA</tt>&#21253;&#35065;&#36215;&#26469;&#12290;&#65289;
                </p><pre class="programlisting">&lt;query name="eg.DomesticCat.by.name.and.minimum.weight"&gt;&lt;![CDATA[
    from eg.DomesticCat as cat
        where cat.name = ?
        and cat.weight &gt; ?
] ]&gt;&lt;/query&gt;</pre><p>
					&#21442;&#25968;&#32465;&#23450;&#21450;&#25191;&#34892;&#20197;&#32534;&#31243;&#26041;&#24335;(programatically)&#23436;&#25104;&#65306;
                </p><pre class="programlisting">Query q = sess.getNamedQuery("eg.DomesticCat.by.name.and.minimum.weight");
q.setString(0, name);
q.setInt(1, minWeight);
List cats = q.list();</pre><p>
                	&#35831;&#27880;&#24847;&#23454;&#38469;&#30340;&#31243;&#24207;&#20195;&#30721;&#19982;&#25152;&#29992;&#30340;&#26597;&#35810;&#35821;&#35328;&#26080;&#20851;&#65292;&#20320;&#20063;&#21487;&#22312;&#20803;&#25968;&#25454;&#20013;&#23450;&#20041;&#21407;&#29983;SQL(native SQL)&#26597;&#35810;&#65292;
                	&#25110;&#23558;&#21407;&#26377;&#30340;&#20854;&#20182;&#30340;&#26597;&#35810;&#35821;&#21477;&#25918;&#22312;&#37197;&#32622;&#25991;&#20214;&#20013;&#65292;&#36825;&#26679;&#23601;&#21487;&#20197;&#35753;Hibernate&#32479;&#19968;&#31649;&#29702;&#65292;&#36798;&#21040;&#36801;&#31227;&#30340;&#30446;&#30340;&#12290;
                </p></div></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="objectstate-filtering"></a>10.4.2.&nbsp;&#36807;&#28388;&#38598;&#21512;</h3></div></div><div></div></div><p>
     		    &#38598;&#21512;<span class="emphasis"><em>&#36807;&#28388;&#22120;(filter)</em></span>&#26159;&#19968;&#31181;&#29992;&#20110;&#19968;&#20010;&#25345;&#20037;&#21270;&#38598;&#21512;&#25110;&#32773;&#25968;&#32452;&#30340;&#29305;&#27530;&#30340;&#26597;&#35810;&#12290;&#26597;&#35810;&#23383;&#31526;&#20018;&#20013;&#21487;&#20197;&#20351;&#29992;<tt class="literal">"this"</tt>&#26469;&#24341;&#29992;&#38598;&#21512;&#20013;&#30340;&#24403;&#21069;&#20803;&#32032;&#12290;
	        </p><pre class="programlisting">Collection blackKittens = session.createFilter(
    pk.getKittens(), 
    "where this.color = ?")
    .setParameter( Color.BLACK, Hibernate.custom(ColorUserType.class) )
    .list()
);</pre><p>
                 &#36820;&#22238;&#30340;&#38598;&#21512;&#21487;&#20197;&#34987;&#35748;&#20026;&#26159;&#19968;&#20010;&#21253;(bag, &#26080;&#39034;&#24207;&#21487;&#37325;&#22797;&#30340;&#38598;&#21512;(collection))&#65292;&#23427;&#26159;&#25152;&#32473;&#38598;&#21512;&#30340;&#21103;&#26412;&#12290;
                &#21407;&#26469;&#30340;&#38598;&#21512;&#19981;&#20250;&#34987;&#25913;&#21160;&#65288;&#36825;&#19982;&#8220;&#36807;&#28388;&#22120;(filter)&#8221;&#30340;&#38544;&#21547;&#30340;&#21547;&#20041;&#19981;&#31526;&#65292;&#19981;&#36807;&#19982;&#25105;&#20204;&#26399;&#24453;&#30340;&#34892;&#20026;&#19968;&#33268;&#65289;&#12290;
            </p><p>
	         	&#35831;&#27880;&#24847;&#36807;&#28388;&#22120;(filter)&#24182;&#19981;&#38656;&#35201;<tt class="literal">from</tt>&#23376;&#21477;&#65288;&#24403;&#28982;&#38656;&#35201;&#30340;&#35805;&#23427;&#20204;&#20063;&#21487;&#20197;&#21152;&#19978;&#65289;&#12290;&#36807;&#28388;&#22120;(filter)&#19981;&#38480;&#23450;&#20110;&#21482;&#33021;&#36820;&#22238;&#38598;&#21512;&#20803;&#32032;&#26412;&#36523;&#12290;
	        </p><pre class="programlisting">Collection blackKittenMates = session.createFilter(
    pk.getKittens(), 
    "select this.mate where this.color = eg.Color.BLACK.intValue")
    .list();</pre><p>
				&#21363;&#20351;&#26080;&#26465;&#20214;&#30340;&#36807;&#28388;&#22120;(filter)&#20063;&#26159;&#26377;&#24847;&#20041;&#30340;&#12290;&#20363;&#22914;&#65292;&#29992;&#20110;&#21152;&#36733;&#19968;&#20010;&#22823;&#38598;&#21512;&#30340;&#23376;&#38598;&#65306;
            </p><pre class="programlisting">Collection tenKittens = session.createFilter(
    mother.getKittens(), "")
    .setFirstResult(0).setMaxResults(10)
    .list();</pre></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="objecstate-querying-criteria"></a>10.4.3.&nbsp;&#26465;&#20214;&#26597;&#35810;(Criteria queries)</h3></div></div><div></div></div><p>
	            HQL&#26497;&#20026;&#24378;&#22823;&#65292;&#20294;&#26159;&#26377;&#20123;&#20154;&#24076;&#26395;&#33021;&#22815;&#21160;&#24577;&#30340;&#20351;&#29992;&#19968;&#31181;&#38754;&#21521;&#23545;&#35937;API&#21019;&#24314;&#26597;&#35810;&#65292;&#32780;&#38750;&#22312;&#20182;&#20204;&#30340;Java&#20195;&#30721;&#20013;&#23884;&#20837;&#23383;&#31526;&#20018;&#12290;&#23545;&#20110;&#37027;&#37096;&#20998;&#20154;&#26469;&#35828;&#65292;Hibernate&#25552;&#20379;&#20102;&#30452;&#35266;&#30340;<tt class="literal">Criteria</tt>&#26597;&#35810;API&#12290;
	        </p><pre class="programlisting">Criteria crit = session.createCriteria(Cat.class);
crit.add( Expression.eq( "color", eg.Color.BLACK ) );
crit.setMaxResults(10);
List cats = crit.list();</pre><p>
                <tt class="literal">Criteria</tt>&#20197;&#21450;&#30456;&#20851;&#30340;<tt class="literal">&#26679;&#20363;(Example)</tt>API&#23558;&#20250;&#20877;<a href="querycriteria.html" title="&#31532;&nbsp;15&nbsp;&#31456;&nbsp;&#xA;    &#26465;&#20214;&#26597;&#35810;(Criteria Queries)&#xA;    ">&#31532;&nbsp;15&nbsp;&#31456; <i>
    &#26465;&#20214;&#26597;&#35810;(Criteria Queries)
    </i></a>&#20013;&#35814;&#32454;&#35752;&#35770;&#12290;
            </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="objectstate-querying-nativesql"></a>10.4.4.&nbsp;&#20351;&#29992;&#21407;&#29983;SQL&#30340;&#26597;&#35810;</h3></div></div><div></div></div><p>
				&#20320;&#21487;&#20197;&#20351;&#29992;<tt class="literal">createSQLQuery()</tt>&#26041;&#27861;&#65292;&#29992;SQL&#26469;&#25551;&#36848;&#26597;&#35810;&#65292;&#24182;&#30001;Hibernate&#23558;&#32467;&#26524;&#38598;&#36716;&#25442;&#25104;&#23545;&#35937;&#12290;
				&#35831;&#27880;&#24847;&#65292;&#20320;&#21487;&#20197;&#22312;&#20219;&#20309;&#26102;&#20505;&#35843;&#29992;<tt class="literal">session.connection()</tt>&#26469;&#33719;&#24471;&#24182;&#20351;&#29992;JDBC <tt class="literal">Connection</tt>&#23545;&#35937;&#12290;
				&#22914;&#26524;&#20320;&#36873;&#25321;&#20351;&#29992;Hibernate&#30340;API, &#20320;&#24517;&#39035;&#25226;SQL&#21035;&#21517;&#29992;&#22823;&#25324;&#21495;&#21253;&#22260;&#36215;&#26469;:
            </p><pre class="programlisting">List cats = session.createSQLQuery(
    "SELECT {cat.*} FROM CAT {cat} WHERE ROWNUM&lt;10",
    "cat",
    Cat.class
).list();</pre><pre class="programlisting">List cats = session.createSQLQuery(
    "SELECT {cat}.ID AS {cat.id}, {cat}.SEX AS {cat.sex}, " +
           "{cat}.MATE AS {cat.mate}, {cat}.SUBCLASS AS {cat.class}, ... " +
    "FROM CAT {cat} WHERE ROWNUM&lt;10",
    "cat",
    Cat.class
).list()</pre><p>
                &#21644;Hibernate&#26597;&#35810;&#19968;&#26679;&#65292;SQL&#26597;&#35810;&#20063;&#21487;&#20197;&#21253;&#21547;&#21629;&#21517;&#21442;&#25968;&#21644;&#21344;&#20301;&#21442;&#25968;&#12290;
			  &#21487;&#20197;&#22312;<a href="querysql.html" title="&#31532;&nbsp;16&nbsp;&#31456;&nbsp;Native SQL&#26597;&#35810;">&#31532;&nbsp;16&nbsp;&#31456; <i>Native SQL&#26597;&#35810;</i></a>&#25214;&#21040;&#26356;&#22810;&#20851;&#20110;Hibernate&#20013;&#21407;&#29983;SQL(native SQL)&#30340;&#20449;&#24687;&#12290;
            </p></div></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="objectstate-modifying"></a>10.5.&nbsp;&#20462;&#25913;&#25345;&#20037;&#23545;&#35937;</h2></div></div><div></div></div><p>
            <span class="emphasis"><em>&#20107;&#21153;&#20013;&#30340;&#25345;&#20037;&#23454;&#20363;</em></span>&#65288;&#23601;&#26159;&#36890;&#36807;<tt class="literal">session</tt>&#35013;&#36733;&#12289;&#20445;&#23384;&#12289;&#21019;&#24314;&#25110;&#32773;&#26597;&#35810;&#20986;&#30340;&#23545;&#35937;&#65289;
            &#34987;&#24212;&#29992;&#31243;&#24207;&#25805;&#20316;&#25152;&#36896;&#25104;&#30340;&#20219;&#20309;&#20462;&#25913;&#37117;&#20250;&#22312;<tt class="literal">Session</tt>&#34987;<span class="emphasis"><em>&#21047;&#20986;&#65288;flushed&#65289;</em></span>&#30340;&#26102;&#20505;&#34987;&#25345;&#20037;&#21270;&#65288;&#26412;&#31456;&#21518;&#38754;&#20250;&#35814;&#32454;&#35752;&#35770;&#65289;&#12290;
			&#36825;&#37324;&#19981;&#38656;&#35201;&#35843;&#29992;&#26576;&#20010;&#29305;&#23450;&#30340;&#26041;&#27861;&#65288;&#27604;&#22914;<tt class="literal">update()</tt>&#65292;&#35774;&#35745;&#23427;&#30340;&#30446;&#30340;&#26159;&#19981;&#21516;&#30340;&#65289;&#23558;&#20320;&#30340;&#20462;&#25913;&#25345;&#20037;&#21270;&#12290;
            &#25152;&#20197;&#26368;&#30452;&#25509;&#30340;&#26356;&#26032;&#19968;&#20010;&#23545;&#35937;&#30340;&#26041;&#27861;&#23601;&#26159;&#22312;<tt class="literal">Session</tt>&#22788;&#20110;&#25171;&#24320;&#29366;&#24577;&#26102;<tt class="literal">load()</tt>&#23427;&#65292;&#28982;&#21518;&#30452;&#25509;&#20462;&#25913;&#21363;&#21487;&#65306;
        </p><pre class="programlisting">DomesticCat cat = (DomesticCat) sess.load( Cat.class, new Long(69) );
cat.setName("PK");
sess.flush();  // changes to cat are automatically detected and persisted</pre><p>
        	&#26377;&#26102;&#36825;&#31181;&#31243;&#24207;&#27169;&#22411;&#25928;&#29575;&#20302;&#19979;&#65292;&#22240;&#20026;&#23427;&#22312;&#21516;&#19968;Session&#37324;&#38656;&#35201;&#19968;&#26465;SQL <tt class="literal">SELECT</tt>&#35821;&#21477;&#65288;&#29992;&#20110;&#21152;&#36733;&#23545;&#35937;&#65289;
        	&#20197;&#21450;&#19968;&#26465;SQL <tt class="literal">UPDATE</tt>&#35821;&#21477;(&#25345;&#20037;&#21270;&#26356;&#26032;&#30340;&#29366;&#24577;)&#12290;
        	&#20026;&#27492;Hibernate&#25552;&#20379;&#20102;&#21478;&#19968;&#31181;&#36884;&#24452;&#65292;&#20351;&#29992;&#33073;&#31649;(detached)&#23454;&#20363;&#12290;
        </p><p>
            <span class="emphasis"><em>&#35831;&#27880;&#24847;Hibernate&#26412;&#36523;&#19981;&#25552;&#20379;&#30452;&#25509;&#25191;&#34892;<tt class="literal">UPDATE</tt>&#25110;<tt class="literal">DELETE</tt>&#35821;&#21477;&#30340;API&#12290;
            Hibernate&#25552;&#20379;&#30340;&#26159;<span class="emphasis"><em>&#29366;&#24577;&#31649;&#29702;(state management)</em></span>&#26381;&#21153;&#65292;&#20320;&#19981;&#24517;&#32771;&#34385;&#35201;&#20351;&#29992;&#30340;<span class="emphasis"><em>&#35821;&#21477;(statements)</em></span>&#12290;
			JDBC&#26159;&#20986;&#33394;&#30340;&#25191;&#34892;SQL&#35821;&#21477;&#30340;API&#65292;&#20219;&#20309;&#26102;&#20505;&#35843;&#29992;<tt class="literal">session.connection()</tt>&#20320;&#37117;&#21487;&#20197;&#24471;&#21040;&#19968;&#20010;JDBC <tt class="literal">Connection</tt>&#23545;&#35937;&#12290;
			&#27492;&#22806;&#65292;&#22312;&#32852;&#26426;&#20107;&#21153;&#22788;&#29702;(OLTP)&#31243;&#24207;&#20013;&#65292;&#22823;&#37327;&#25805;&#20316;(mass operations)&#19982;&#23545;&#35937;/&#20851;&#31995;&#26144;&#23556;&#30340;&#35266;&#28857;&#26159;&#30456;&#20914;&#31361;&#30340;&#12290;
            Hibernate&#30340;&#23558;&#26469;&#29256;&#26412;&#21487;&#33021;&#20250;&#25552;&#20379;&#19987;&#38376;&#30340;&#36827;&#34892;&#22823;&#37327;&#25805;&#20316;(mass operation)&#30340;&#21151;&#33021;&#12290;            
            &#21442;&#32771;<a href="batch.html" title="&#31532;&nbsp;13&nbsp;&#31456;&nbsp;&#25209;&#37327;&#22788;&#29702;&#65288;Batch processing&#65289;">&#31532;&nbsp;13&nbsp;&#31456; <i>&#25209;&#37327;&#22788;&#29702;&#65288;Batch processing&#65289;</i></a>&#65292;&#23547;&#25214;&#19968;&#20123;&#21487;&#29992;&#30340;&#25209;&#37327;(batch)&#25805;&#20316;&#25216;&#24039;&#12290;</em></span>
        </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="objectstate-detached"></a>10.6.&nbsp;&#20462;&#25913;&#33073;&#31649;(Detached)&#23545;&#35937;</h2></div></div><div></div></div><p>
            &#24456;&#22810;&#31243;&#24207;&#38656;&#35201;&#22312;&#26576;&#20010;&#20107;&#21153;&#20013;&#33719;&#21462;&#23545;&#35937;&#65292;&#28982;&#21518;&#23558;&#23545;&#35937;&#21457;&#36865;&#21040;&#30028;&#38754;&#23618;&#21435;&#25805;&#20316;&#65292;&#26368;&#21518;&#22312;&#19968;&#20010;&#26032;&#30340;&#20107;&#21153;&#20445;&#23384;&#25152;&#20570;&#30340;&#20462;&#25913;&#12290;
            &#22312;&#39640;&#24182;&#21457;&#35775;&#38382;&#30340;&#29615;&#22659;&#20013;&#20351;&#29992;&#36825;&#31181;&#26041;&#24335;&#65292;&#36890;&#24120;&#20351;&#29992;&#38468;&#24102;&#29256;&#26412;&#20449;&#24687;&#30340;&#25968;&#25454;&#26469;&#20445;&#35777;&#36825;&#20123;&#8220;&#38271;&#8220;&#24037;&#20316;&#21333;&#20803;&#20043;&#38388;&#30340;&#38548;&#31163;&#12290;
        </p><p>
        	Hibernate&#36890;&#36807;&#25552;&#20379;<tt class="literal">Session.update()</tt>&#25110;<tt class="literal">Session.merge()</tt>
        	&#37325;&#26032;&#20851;&#32852;&#33073;&#31649;&#23454;&#20363;&#30340;&#21150;&#27861;&#26469;&#25903;&#25345;&#36825;&#31181;&#27169;&#22411;&#12290;
        </p><pre class="programlisting">// in the first session
Cat cat = (Cat) firstSession.load(Cat.class, catId);
Cat potentialMate = new Cat();
firstSession.save(potentialMate);

// in a higher layer of the application
cat.setMate(potentialMate);

// later, in a new session
secondSession.update(cat);  // update cat
secondSession.update(mate); // update mate</pre><p>
            &#22914;&#26524;&#20855;&#26377;<tt class="literal">catId</tt>&#25345;&#20037;&#21270;&#26631;&#35782;&#30340;<tt class="literal">Cat</tt>&#20043;&#21069;&#24050;&#32463;&#34987;<tt class="literal">&#21478;&#19968;Session(secondSession)</tt>&#35013;&#36733;&#20102;&#65292;
            &#24212;&#29992;&#31243;&#24207;&#36827;&#34892;&#37325;&#20851;&#32852;&#25805;&#20316;(reattach)&#30340;&#26102;&#20505;&#20250;&#25243;&#20986;&#19968;&#20010;&#24322;&#24120;&#12290;
        </p><p>
        	&#22914;&#26524;&#20320;&#30830;&#23450;&#24403;&#21069;session&#27809;&#26377;&#21253;&#21547;&#19982;&#20043;&#20855;&#26377;&#30456;&#21516;&#25345;&#20037;&#21270;&#26631;&#35782;&#30340;&#25345;&#20037;&#23454;&#20363;&#65292;&#20351;&#29992;<tt class="literal">update()</tt>&#12290;
        	&#22914;&#26524;&#24819;&#38543;&#26102;&#21512;&#24182;&#20320;&#30340;&#30340;&#25913;&#21160;&#32780;&#19981;&#32771;&#34385;session&#30340;&#29366;&#24577;&#65292;&#20351;&#29992;<tt class="literal">merge()</tt>&#12290;
	         &#25442;&#21477;&#35805;&#35828;&#65292;&#22312;&#19968;&#20010;&#26032;session&#20013;&#36890;&#24120;&#31532;&#19968;&#20010;&#35843;&#29992;&#30340;&#26159;<tt class="literal">update()</tt>&#26041;&#27861;&#65292;&#20197;&#20415;&#20445;&#35777;&#37325;&#26032;&#20851;&#32852;&#33073;&#31649;(detached)&#23545;&#35937;&#30340;&#25805;&#20316;&#39318;&#20808;&#34987;&#25191;&#34892;&#12290;
        </p><p>
		    &#22914;&#26524;&#24076;&#26395;&#30456;&#20851;&#32852;&#30340;&#33073;&#31649;&#23545;&#35937;&#65288;&#36890;&#36807;&#24341;&#29992;&#8220;&#21487;&#21040;&#36798;&#8221;&#30340;&#33073;&#31649;&#23545;&#35937;&#65289;&#30340;&#25968;&#25454;&#20063;&#35201;&#26356;&#26032;&#21040;&#25968;&#25454;&#24211;&#26102;&#65288;&#24182;&#19988;&#20063;<span class="emphasis"><em>&#20165;&#20165;</em></span>&#22312;&#36825;&#31181;&#24773;&#20917;&#65289;&#65292;
		    &#21487;&#20197;&#23545;&#35813;&#30456;&#20851;&#32852;&#30340;&#33073;&#31649;&#23545;&#35937;&#21333;&#29420;&#35843;&#29992;<tt class="literal">update()</tt>
			&#24403;&#28982;&#36825;&#20123;&#21487;&#20197;&#33258;&#21160;&#23436;&#25104;&#65292;&#21363;&#36890;&#36807;&#20351;&#29992;<span class="emphasis"><em>&#20256;&#25773;&#24615;&#25345;&#20037;&#21270;(transitive persistence)</em></span>&#65292;&#35831;&#30475;<a href="objectstate.html#objectstate-transitive" title="10.11.&nbsp;&#20256;&#25773;&#24615;&#25345;&#20037;&#21270;(transitive persistence)">&#31532;&nbsp;10.11&nbsp;&#33410; &#8220;&#20256;&#25773;&#24615;&#25345;&#20037;&#21270;(transitive persistence)&#8221;</a>&#12290;
        </p><p>
            <tt class="literal">lock()</tt>&#26041;&#27861;&#20063;&#20801;&#35768;&#31243;&#24207;&#37325;&#26032;&#20851;&#32852;&#26576;&#20010;&#23545;&#35937;&#21040;&#19968;&#20010;&#26032;session&#19978;&#12290;&#19981;&#36807;&#65292;&#35813;&#33073;&#31649;(detached)&#30340;&#23545;&#35937;&#24517;&#39035;&#26159;&#27809;&#26377;&#20462;&#25913;&#36807;&#30340;&#65281;
        </p><pre class="programlisting">//just reassociate:
sess.lock(fritz, LockMode.NONE);
//do a version check, then reassociate:
sess.lock(izi, LockMode.READ);
//do a version check, using SELECT ... FOR UPDATE, then reassociate:
sess.lock(pk, LockMode.UPGRADE);</pre><p>
            &#35831;&#27880;&#24847;&#65292;<tt class="literal">lock()</tt>&#21487;&#20197;&#25645;&#37197;&#22810;&#31181;<tt class="literal">LockMode</tt>&#65292;
            &#26356;&#22810;&#20449;&#24687;&#35831;&#38405;&#35835;API&#25991;&#26723;&#20197;&#21450;&#20851;&#20110;&#20107;&#21153;&#22788;&#29702;(transaction handling)&#30340;&#31456;&#33410;&#12290;&#37325;&#26032;&#20851;&#32852;&#19981;&#26159;<tt class="literal">lock()</tt>&#30340;&#21807;&#19968;&#29992;&#36884;&#12290;
        </p><p>
            &#20854;&#20182;&#29992;&#20110;&#38271;&#26102;&#38388;&#24037;&#20316;&#21333;&#20803;&#30340;&#27169;&#22411;&#20250;&#22312;<a href="transactions.html#transactions-optimistic" title="11.3.&nbsp;&#20048;&#35266;&#24182;&#21457;&#25511;&#21046;(Optimistic concurrency control)">&#31532;&nbsp;11.3&nbsp;&#33410; &#8220;&#20048;&#35266;&#24182;&#21457;&#25511;&#21046;(Optimistic concurrency control)&#8221;</a>&#20013;&#35752;&#35770;&#12290;
        </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="objectstate-saveorupdate"></a>10.7.&nbsp;&#33258;&#21160;&#29366;&#24577;&#26816;&#27979;</h2></div></div><div></div></div><p>
            Hibernate&#30340;&#29992;&#25143;&#26366;&#35201;&#27714;&#19968;&#20010;&#26082;&#21487;&#33258;&#21160;&#20998;&#37197;&#26032;&#25345;&#20037;&#21270;&#26631;&#35782;(identifier)&#20445;&#23384;&#30636;&#26102;(transient)&#23545;&#35937;&#65292;&#21448;&#21487;&#26356;&#26032;/&#37325;&#26032;&#20851;&#32852;&#33073;&#31649;(detached)&#23454;&#20363;&#30340;&#36890;&#29992;&#26041;&#27861;&#12290;
            <tt class="literal">saveOrUpdate()</tt>&#26041;&#27861;&#23454;&#29616;&#20102;&#36825;&#20010;&#21151;&#33021;&#12290;
        </p><pre class="programlisting">// in the first session
Cat cat = (Cat) firstSession.load(Cat.class, catID);

// in a higher tier of the application
Cat mate = new Cat();
cat.setMate(mate);

// later, in a new session
secondSession.saveOrUpdate(cat);   // update existing state (cat has a non-null id)
secondSession.saveOrUpdate(mate);  // save the new instance (mate has a null id)</pre><p>
            <tt class="literal">saveOrUpdate()</tt>&#29992;&#36884;&#21644;&#35821;&#20041;&#21487;&#33021;&#20250;&#20351;&#26032;&#29992;&#25143;&#24863;&#21040;&#36855;&#24785;&#12290;
			&#39318;&#20808;&#65292;&#21482;&#35201;&#20320;&#27809;&#26377;&#23581;&#35797;&#22312;&#26576;&#20010;session&#20013;&#20351;&#29992;&#26469;&#33258;&#21478;&#19968;session&#30340;&#23454;&#20363;&#65292;&#20320;&#23601;&#24212;&#35813;&#19981;&#38656;&#35201;&#20351;&#29992;<tt class="literal">update()</tt>&#65292;
            <tt class="literal">saveOrUpdate()</tt>&#65292;&#25110;<tt class="literal">merge()</tt>&#12290;&#26377;&#20123;&#31243;&#24207;&#20174;&#26469;&#19981;&#29992;&#36825;&#20123;&#26041;&#27861;&#12290;
        </p><p>
            &#36890;&#24120;&#19979;&#38754;&#30340;&#22330;&#26223;&#20250;&#20351;&#29992;<tt class="literal">update()</tt>&#25110;<tt class="literal">saveOrUpdate()</tt>&#65306;
        </p><div class="itemizedlist"><ul type="disc" compact><li><p>
                    &#31243;&#24207;&#22312;&#31532;&#19968;&#20010;session&#20013;&#21152;&#36733;&#23545;&#35937;
                </p></li><li><p>
                    &#35813;&#23545;&#35937;&#34987;&#20256;&#36882;&#21040;&#34920;&#29616;&#23618;
                </p></li><li><p>
					&#23545;&#35937;&#21457;&#29983;&#20102;&#19968;&#20123;&#25913;&#21160;
                </p></li><li><p>
					&#35813;&#23545;&#35937;&#34987;&#36820;&#22238;&#21040;&#19994;&#21153;&#36923;&#36753;&#23618;
                </p></li><li><p>
                    &#31243;&#24207;&#35843;&#29992;&#31532;&#20108;&#20010;session&#30340;<tt class="literal">update()</tt>&#26041;&#27861;&#25345;&#20037;&#36825;&#20123;&#25913;&#21160;
                </p></li></ul></div><p>
            <tt class="literal">saveOrUpdate()</tt>&#20570;&#19979;&#38754;&#30340;&#20107;:
        </p><div class="itemizedlist"><ul type="disc" compact><li><p>
                    &#22914;&#26524;&#23545;&#35937;&#24050;&#32463;&#22312;&#26412;session&#20013;&#25345;&#20037;&#21270;&#20102;&#65292;&#19981;&#20570;&#20219;&#20309;&#20107;
                </p></li><li><p>
                	&#22914;&#26524;&#21478;&#19968;&#20010;&#19982;&#26412;session&#20851;&#32852;&#30340;&#23545;&#35937;&#25317;&#26377;&#30456;&#21516;&#30340;&#25345;&#20037;&#21270;&#26631;&#35782;(identifier)&#65292;&#25243;&#20986;&#19968;&#20010;&#24322;&#24120;
                </p></li><li><p>
					&#22914;&#26524;&#23545;&#35937;&#27809;&#26377;&#25345;&#20037;&#21270;&#26631;&#35782;(identifier)&#23646;&#24615;&#65292;&#23545;&#20854;&#35843;&#29992;<tt class="literal">save()</tt>
                </p></li><li><p>
                	&#22914;&#26524;&#23545;&#35937;&#30340;&#25345;&#20037;&#26631;&#35782;(identifier)&#34920;&#26126;&#20854;&#26159;&#19968;&#20010;&#26032;&#23454;&#20363;&#21270;&#30340;&#23545;&#35937;&#65292;&#23545;&#20854;&#35843;&#29992;<tt class="literal">save()</tt>
                </p></li><li><p>
              		&#22914;&#26524;&#23545;&#35937;&#26159;&#38468;&#24102;&#29256;&#26412;&#20449;&#24687;&#30340;&#65288;&#36890;&#36807;<tt class="literal">&lt;version&gt;</tt>&#25110;<tt class="literal">&lt;timestamp&gt;</tt>&#65289;
					&#24182;&#19988;&#29256;&#26412;&#23646;&#24615;&#30340;&#20540;&#34920;&#26126;&#20854;&#26159;&#19968;&#20010;&#26032;&#23454;&#20363;&#21270;&#30340;&#23545;&#35937;&#65292;<tt class="literal">save()</tt>&#23427;&#12290;
                </p></li><li><p>
                    &#21542;&#21017;<tt class="literal">update()</tt> &#36825;&#20010;&#23545;&#35937;
                </p></li></ul></div><p>
            <tt class="literal">merge()</tt>&#21487;&#38750;&#24120;&#19981;&#21516;:
        </p><div class="itemizedlist"><ul type="disc" compact><li><p>
                	&#22914;&#26524;session&#20013;&#23384;&#22312;&#30456;&#21516;&#25345;&#20037;&#21270;&#26631;&#35782;(identifier)&#30340;&#23454;&#20363;&#65292;&#29992;&#29992;&#25143;&#32473;&#20986;&#30340;&#23545;&#35937;&#30340;&#29366;&#24577;&#35206;&#30422;&#26087;&#26377;&#30340;&#25345;&#20037;&#23454;&#20363;
                </p></li><li><p>
                	&#22914;&#26524;session&#27809;&#26377;&#30456;&#24212;&#30340;&#25345;&#20037;&#23454;&#20363;&#65292;&#21017;&#23581;&#35797;&#20174;&#25968;&#25454;&#24211;&#20013;&#21152;&#36733;&#65292;&#25110;&#21019;&#24314;&#26032;&#30340;&#25345;&#20037;&#21270;&#23454;&#20363;
                </p></li><li><p>
					&#26368;&#21518;&#36820;&#22238;&#35813;&#25345;&#20037;&#23454;&#20363;
                </p></li><li><p>
                	&#29992;&#25143;&#32473;&#20986;&#30340;&#36825;&#20010;&#23545;&#35937;&#27809;&#26377;&#34987;&#20851;&#32852;&#21040;session&#19978;&#65292;&#23427;&#20381;&#26087;&#26159;&#33073;&#31649;&#30340;
                </p></li></ul></div></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="objectstate-deleting"></a>10.8.&nbsp;&#21024;&#38500;&#25345;&#20037;&#23545;&#35937;</h2></div></div><div></div></div><p>
            &#20351;&#29992;<tt class="literal">Session.delete()</tt>&#20250;&#25226;&#23545;&#35937;&#30340;&#29366;&#24577;&#20174;&#25968;&#25454;&#24211;&#20013;&#31227;&#38500;&#12290;
            &#24403;&#28982;&#65292;&#20320;&#30340;&#24212;&#29992;&#31243;&#24207;&#21487;&#33021;&#20173;&#28982;&#25345;&#26377;&#19968;&#20010;&#25351;&#21521;&#24050;&#21024;&#38500;&#23545;&#35937;&#30340;&#24341;&#29992;&#12290;&#25152;&#20197;&#65292;&#26368;&#22909;&#36825;&#26679;&#29702;&#35299;&#65306;<tt class="literal">delete()</tt>&#30340;&#29992;&#36884;&#26159;&#25226;&#19968;&#20010;&#25345;&#20037;&#23454;&#20363;&#21464;&#25104;&#30636;&#26102;(transient)&#23454;&#20363;&#12290;
        </p><pre class="programlisting">sess.delete(cat);</pre><p>
            &#20320;&#21487;&#20197;&#29992;&#20320;&#21916;&#27426;&#30340;&#20219;&#20309;&#39034;&#24207;&#21024;&#38500;&#23545;&#35937;&#65292;&#19981;&#29992;&#25285;&#24515;&#22806;&#38190;&#32422;&#26463;&#20914;&#31361;&#12290;&#24403;&#28982;&#65292;&#22914;&#26524;&#20320;&#25630;&#38169;&#20102;&#39034;&#24207;&#65292;&#36824;&#26159;&#26377;&#21487;&#33021;&#24341;&#21457;&#22312;&#22806;&#38190;&#23383;&#27573;&#23450;&#20041;&#30340;<tt class="literal">NOT NULL</tt>&#32422;&#26463;&#20914;&#31361;&#12290;
            &#20363;&#22914;&#20320;&#21024;&#38500;&#20102;&#29238;&#23545;&#35937;&#65292;&#20294;&#26159;&#24536;&#35760;&#21024;&#38500;&#23401;&#23376;&#20204;&#12290;
        </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="objectstate-replicating"></a>10.9.&nbsp;&#22312;&#20004;&#20010;&#19981;&#21516;&#25968;&#25454;&#24211;&#38388;&#22797;&#21046;&#23545;&#35937;</h2></div></div><div></div></div><p>
    		&#20598;&#23572;&#20250;&#29992;&#21040;&#19981;&#37325;&#26032;&#29983;&#25104;&#25345;&#20037;&#21270;&#26631;&#35782;(identifier)&#65292;&#23558;&#25345;&#20037;&#23454;&#20363;&#20197;&#21450;&#20854;&#20851;&#32852;&#30340;&#23454;&#20363;&#25345;&#20037;&#21040;&#19981;&#21516;&#30340;&#25968;&#25454;&#24211;&#20013;&#30340;&#25805;&#20316;&#12290;
    	</p><pre class="programlisting">//retrieve a cat from one database
Session session1 = factory1.openSession();
Transaction tx1 = session1.beginTransaction();
Cat cat = session1.get(Cat.class, catId);
tx1.commit();
session1.close();

//reconcile with a second database
Session session2 = factory2.openSession();
Transaction tx2 = session2.beginTransaction();
session2.replicate(cat, ReplicationMode.LATEST_VERSION);
tx2.commit();
session2.close();</pre><p>
            <tt class="literal">ReplicationMode</tt>&#20915;&#23450;&#22312;&#21644;&#25968;&#25454;&#24211;&#20013;&#24050;&#23384;&#22312;&#35760;&#24405;&#30001;&#20914;&#31361;&#26102;&#65292;<tt class="literal">replicate()</tt>&#22914;&#20309;&#22788;&#29702;&#12290;
        </p><div class="itemizedlist"><ul type="disc" compact><li><p>
                    <tt class="literal">ReplicationMode.IGNORE</tt> - &#24573;&#30053;&#23427;
                </p></li><li><p>
                    <tt class="literal">ReplicationMode.OVERWRITE</tt> - &#35206;&#30422;&#30456;&#21516;&#30340;&#34892;
                </p></li><li><p>
                    <tt class="literal">ReplicationMode.EXCEPTION</tt> - &#25243;&#20986;&#24322;&#24120;
                </p></li><li><p>
                    <tt class="literal">ReplicationMode.LATEST_VERSION</tt> - &#22914;&#26524;&#24403;&#21069;&#30340;&#29256;&#26412;&#36739;&#26032;&#65292;&#21017;&#35206;&#30422;&#65292;&#21542;&#21017;&#24573;&#30053;
                </p></li></ul></div><p>
        	&#36825;&#20010;&#21151;&#33021;&#30340;&#29992;&#36884;&#21253;&#25324;&#20351;&#24405;&#20837;&#30340;&#25968;&#25454;&#22312;&#19981;&#21516;&#25968;&#25454;&#24211;&#20013;&#19968;&#33268;&#65292;&#20135;&#21697;&#21319;&#32423;&#26102;&#21319;&#32423;&#31995;&#32479;&#37197;&#32622;&#20449;&#24687;&#65292;&#22238;&#28378;non-ACID&#20107;&#21153;&#20013;&#30340;&#20462;&#25913;&#31561;&#31561;&#12290;
        	&#65288;&#35793;&#27880;&#65292;non-ACID&#65292;&#38750;ACID;ACID&#65292;Atomic&#65292;Consistent&#65292;Isolated and Durable&#30340;&#32553;&#20889;&#65289;
        </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="objectstate-flushing"></a>10.10.&nbsp;Session&#21047;&#20986;(flush)</h2></div></div><div></div></div><p>
            &#27599;&#38388;&#38548;&#19968;&#27573;&#26102;&#38388;&#65292;<tt class="literal">Session</tt>&#20250;&#25191;&#34892;&#19968;&#20123;&#24517;&#38656;&#30340;SQL&#35821;&#21477;&#26469;&#25226;&#20869;&#23384;&#20013;&#30340;&#23545;&#35937;&#30340;&#29366;&#24577;&#21516;&#27493;&#21040;JDBC&#36830;&#25509;&#20013;&#12290;&#36825;&#20010;&#36807;&#31243;&#34987;&#31216;&#20026;<span class="emphasis"><em>&#21047;&#20986;(flush)</em></span>&#65292;&#40664;&#35748;&#20250;&#22312;&#19979;&#38754;&#30340;&#26102;&#38388;&#28857;&#25191;&#34892;&#65306;
        </p><div class="itemizedlist"><ul type="disc" compact><li><p>
                    &#22312;&#26576;&#20123;&#26597;&#35810;&#25191;&#34892;&#20043;&#21069;
                </p></li><li><p>
                    &#22312;&#35843;&#29992;<tt class="literal">org.hibernate.Transaction.commit()</tt>&#30340;&#26102;&#20505;
                </p></li><li><p>
                    &#22312;&#35843;&#29992;<tt class="literal">Session.flush()</tt>&#30340;&#26102;&#20505;
                </p></li></ul></div><p>
            &#28041;&#21450;&#30340;SQL&#35821;&#21477;&#20250;&#25353;&#29031;&#19979;&#38754;&#30340;&#39034;&#24207;&#21457;&#20986;&#25191;&#34892;&#65306;
        </p><div class="orderedlist"><ol type="1" compact><li><p>
                    &#25152;&#26377;&#23545;&#23454;&#20307;&#36827;&#34892;&#25554;&#20837;&#30340;&#35821;&#21477;&#65292;&#20854;&#39034;&#24207;&#25353;&#29031;&#23545;&#35937;&#25191;&#34892;<tt class="literal">Session.save()</tt>&#30340;&#26102;&#38388;&#39034;&#24207;
                </p></li><li><p>
                    &#25152;&#26377;&#23545;&#23454;&#20307;&#36827;&#34892;&#26356;&#26032;&#30340;&#35821;&#21477;
                </p></li><li><p>
                    &#25152;&#26377;&#36827;&#34892;&#38598;&#21512;&#21024;&#38500;&#30340;&#35821;&#21477;
                </p></li><li><p>
                    &#25152;&#26377;&#23545;&#38598;&#21512;&#20803;&#32032;&#36827;&#34892;&#21024;&#38500;&#65292;&#26356;&#26032;&#25110;&#32773;&#25554;&#20837;&#30340;&#35821;&#21477;
                </p></li><li><p>
                    &#25152;&#26377;&#36827;&#34892;&#38598;&#21512;&#25554;&#20837;&#30340;&#35821;&#21477;
                </p></li><li><p>
                    &#25152;&#26377;&#23545;&#23454;&#20307;&#36827;&#34892;&#21024;&#38500;&#30340;&#35821;&#21477;&#65292;&#20854;&#39034;&#24207;&#25353;&#29031;&#23545;&#35937;&#25191;&#34892;<tt class="literal">Session.delete()</tt>&#30340;&#26102;&#38388;&#39034;&#24207;
                </p></li></ol></div><p>
            &#65288;&#26377;&#19968;&#20010;&#20363;&#22806;&#26159;&#65292;&#22914;&#26524;&#23545;&#35937;&#20351;&#29992;<tt class="literal">native</tt>&#26041;&#24335;&#26469;&#29983;&#25104;ID&#65288;&#25345;&#20037;&#21270;&#26631;&#35782;&#65289;&#30340;&#35805;&#65292;&#23427;&#20204;&#19968;&#25191;&#34892;save&#23601;&#20250;&#34987;&#25554;&#20837;&#12290;&#65289;
        </p><p>
            &#38500;&#38750;&#20320;&#26126;&#30830;&#22320;&#21457;&#20986;&#20102;<tt class="literal">flush()</tt>&#25351;&#20196;&#65292;&#20851;&#20110;Session<span class="emphasis"><em>&#20309;&#26102;</em></span>&#20250;&#25191;&#34892;&#36825;&#20123;JDBC&#35843;&#29992;&#26159;&#23436;&#20840;&#26080;&#27861;&#20445;&#35777;&#30340;&#65292;&#21482;&#33021;&#20445;&#35777;&#23427;&#20204;&#25191;&#34892;&#30340;&#21069;&#21518;&#39034;&#24207;&#12290;
            &#24403;&#28982;&#65292;Hibernate&#20445;&#35777;&#65292;<tt class="literal">Query.list(..)</tt>&#32477;&#23545;&#19981;&#20250;&#36820;&#22238;&#24050;&#32463;&#22833;&#25928;&#30340;&#25968;&#25454;&#65292;&#20063;&#19981;&#20250;&#36820;&#22238;&#38169;&#35823;&#25968;&#25454;&#12290;
        </p><p>
            &#20063;&#21487;&#20197;&#25913;&#21464;&#40664;&#35748;&#30340;&#35774;&#32622;&#65292;&#26469;&#35753;&#21047;&#20986;(flush)&#25805;&#20316;&#21457;&#29983;&#30340;&#19981;&#37027;&#20040;&#39057;&#32321;&#12290;
            <tt class="literal">FlushMode</tt>&#31867;&#23450;&#20041;&#20102;&#19977;&#31181;&#19981;&#21516;&#30340;&#26041;&#24335;&#12290;
              &#20165;&#22312;&#25552;&#20132;&#26102;&#21047;&#20986;(&#20165;&#24403;Hibernate&#30340;<tt class="literal">Transaction</tt> API&#34987;&#20351;&#29992;&#26102;&#26377;&#25928;)&#65292;
              &#25353;&#29031;&#21018;&#25165;&#35828;&#30340;&#26041;&#24335;&#21047;&#20986;&#65292;
              &#20197;&#21450;&#38500;&#38750;&#26126;&#30830;&#20351;&#29992;<tt class="literal">flush()</tt>&#21542;&#21017;&#20174;&#19981;&#21047;&#20986;&#12290;
              &#26368;&#21518;&#19968;&#31181;&#27169;&#24335;&#23545;&#20110;&#37027;&#20123;&#38656;&#35201;&#38271;&#26102;&#38388;&#20445;&#25345;<tt class="literal">Session</tt>&#20026;&#25171;&#24320;&#25110;&#32773;&#26029;&#32447;&#29366;&#24577;&#30340;&#38271;&#26102;&#38388;&#36816;&#34892;&#30340;&#24037;&#20316;&#21333;&#20803;&#24456;&#26377;&#29992;&#12290;
            (&#21442;&#35265; <a href="transactions.html#transactions-optimistic-longsession" title="11.3.2.&nbsp;&#25193;&#23637;&#21608;&#26399;&#30340;session&#21644;&#33258;&#21160;&#29256;&#26412;&#21270;">&#31532;&nbsp;11.3.2&nbsp;&#33410; &#8220;&#25193;&#23637;&#21608;&#26399;&#30340;session&#21644;&#33258;&#21160;&#29256;&#26412;&#21270;&#8221;</a>).
        </p><pre class="programlisting">sess = sf.openSession();
Transaction tx = sess.beginTransaction();
sess.setFlushMode(FlushMode.COMMIT); // allow queries to return stale state

Cat izi = (Cat) sess.load(Cat.class, id);
izi.setName(iznizi);

// might return stale data
sess.find("from Cat as cat left outer join cat.kittens kitten");

// change to izi is not flushed!
...
tx.commit(); // flush occurs
sess.close();</pre><p>
        	&#21047;&#20986;(flush)&#26399;&#38388;&#65292;&#21487;&#33021;&#20250;&#25243;&#20986;&#24322;&#24120;&#12290;&#65288;&#20363;&#22914;&#19968;&#20010;DML&#25805;&#20316;&#36829;&#21453;&#20102;&#32422;&#26463;&#65289;
			&#24322;&#24120;&#22788;&#29702;&#28041;&#21450;&#21040;&#23545;Hibernate&#20107;&#21153;&#24615;&#34892;&#20026;&#30340;&#29702;&#35299;&#65292;&#22240;&#27492;&#25105;&#20204;&#23558;&#22312;<a href="transactions.html" title="&#31532;&nbsp;11&nbsp;&#31456;&nbsp;&#20107;&#21153;&#21644;&#24182;&#21457;">&#31532;&nbsp;11&nbsp;&#31456; <i>&#20107;&#21153;&#21644;&#24182;&#21457;</i></a>&#20013;&#35752;&#35770;&#12290;
        </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="objectstate-transitive"></a>10.11.&nbsp;&#20256;&#25773;&#24615;&#25345;&#20037;&#21270;(transitive persistence)</h2></div></div><div></div></div><p>
           	&#23545;&#27599;&#19968;&#20010;&#23545;&#35937;&#37117;&#35201;&#25191;&#34892;&#20445;&#23384;&#65292;&#21024;&#38500;&#25110;&#37325;&#20851;&#32852;&#25805;&#20316;&#35753;&#20154;&#24863;&#35273;&#26377;&#28857;&#40635;&#28902;&#65292;&#23588;&#20854;&#26159;&#22312;&#22788;&#29702;&#35768;&#22810;&#24444;&#27492;&#20851;&#32852;&#30340;&#23545;&#35937;&#30340;&#26102;&#20505;&#12290;
             &#19968;&#20010;&#24120;&#35265;&#30340;&#20363;&#23376;&#26159;&#29238;&#23376;&#20851;&#31995;&#12290;&#32771;&#34385;&#19979;&#38754;&#30340;&#20363;&#23376;:
        </p><p>
        	&#22914;&#26524;&#19968;&#20010;&#29238;&#23376;&#20851;&#31995;&#20013;&#30340;&#23376;&#23545;&#35937;&#26159;&#20540;&#31867;&#22411;(value typed)&#65288;&#20363;&#22914;&#65292;&#22320;&#22336;&#25110;&#23383;&#31526;&#20018;&#30340;&#38598;&#21512;&#65289;&#30340;&#65292;&#20182;&#20204;&#30340;&#29983;&#21629;&#21608;&#26399;&#20250;&#20381;&#36182;&#20110;&#29238;&#23545;&#35937;&#65292;&#21487;&#20197;&#20139;&#21463;&#26041;&#20415;&#30340;&#32423;&#32852;&#25805;&#20316;(Cascading)&#65292;&#19981;&#38656;&#35201;&#39069;&#22806;&#30340;&#21160;&#20316;&#12290;
			&#29238;&#23545;&#35937;&#34987;&#20445;&#23384;&#26102;&#65292;&#36825;&#20123;&#20540;&#31867;&#22411;(value typed)&#23376;&#23545;&#35937;&#20063;&#23558;&#34987;&#20445;&#23384;&#65307;&#29238;&#23545;&#35937;&#34987;&#21024;&#38500;&#26102;&#65292;&#23376;&#23545;&#35937;&#20063;&#23558;&#34987;&#21024;&#38500;&#12290;
			&#36825;&#23545;&#23558;&#19968;&#20010;&#23376;&#23545;&#35937;&#20174;&#38598;&#21512;&#20013;&#31227;&#38500;&#26159;&#21516;&#26679;&#26377;&#25928;&#65306;Hibernate&#20250;&#26816;&#27979;&#21040;&#65292;&#24182;&#19988;&#22240;&#20026;&#20540;&#31867;&#22411;(value typed)&#30340;&#23545;&#35937;&#19981;&#21487;&#33021;&#34987;&#20854;&#20182;&#23545;&#35937;&#24341;&#29992;&#65292;&#25152;&#20197;Hibernate&#20250;&#22312;&#25968;&#25454;&#24211;&#20013;&#21024;&#38500;&#36825;&#20010;&#23376;&#23545;&#35937;&#12290;
        </p><p>
        	&#29616;&#22312;&#32771;&#34385;&#21516;&#26679;&#30340;&#22330;&#26223;&#65292;&#19981;&#36807;&#29238;&#23376;&#23545;&#35937;&#37117;&#26159;&#23454;&#20307;(entities)&#31867;&#22411;&#65292;&#32780;&#38750;&#20540;&#31867;&#22411;(value typed)&#65288;&#20363;&#22914;&#65292;&#31867;&#21035;&#19982;&#20010;&#20307;&#65292;&#25110;&#27597;&#29483;&#21644;&#23567;&#29483;&#65289;&#12290;
			&#23454;&#20307;&#26377;&#33258;&#24049;&#30340;&#29983;&#21629;&#26399;&#65292;&#20801;&#35768;&#20849;&#20139;&#23545;&#20854;&#30340;&#24341;&#29992;&#65288;&#22240;&#27492;&#20174;&#38598;&#21512;&#20013;&#31227;&#38500;&#19968;&#20010;&#23454;&#20307;&#65292;&#19981;&#24847;&#21619;&#30528;&#23427;&#21487;&#20197;&#34987;&#21024;&#38500;&#65289;&#65292;
			&#24182;&#19988;&#23454;&#20307;&#21040;&#20854;&#20182;&#20851;&#32852;&#23454;&#20307;&#20043;&#38388;&#40664;&#35748;&#27809;&#26377;&#32423;&#32852;&#25805;&#20316;&#30340;&#35774;&#32622;&#12290;
            Hibernate&#40664;&#35748;&#19981;&#23454;&#29616;&#25152;&#35859;&#30340;<span class="emphasis"><em>&#21487;&#21040;&#36798;&#21363;&#25345;&#20037;&#21270;&#65288;persistence by reachability&#65289;</em></span>&#30340;&#31574;&#30053;&#12290;
        </p><p>
        	&#27599;&#20010;Hibernate session&#30340;&#22522;&#26412;&#25805;&#20316; - &#21253;&#25324; <tt class="literal">persist(), merge(),
            saveOrUpdate(), delete(), lock(), refresh(), evict(), replicate()</tt> - &#37117;&#26377;&#23545;&#24212;&#30340;&#32423;&#32852;&#39118;&#26684;(cascade style)&#12290;
    		&#36825;&#20123;&#32423;&#32852;&#39118;&#26684;(cascade style)&#39118;&#26684;&#20998;&#21035;&#21629;&#21517;&#20026; <tt class="literal">create, 
            merge, save-update, delete, lock, refresh, evict, replicate</tt>&#12290;
            &#22914;&#26524;&#20320;&#24076;&#26395;&#19968;&#20010;&#25805;&#20316;&#34987;&#39034;&#30528;&#20851;&#32852;&#20851;&#31995;&#32423;&#32852;&#20256;&#25773;&#65292;&#20320;&#24517;&#39035;&#22312;&#26144;&#23556;&#25991;&#20214;&#20013;&#25351;&#20986;&#36825;&#19968;&#28857;&#12290;&#20363;&#22914;&#65306;
        </p><pre class="programlisting">&lt;one-to-one name="person" cascade="persist"/&gt;</pre><p>
            &#32423;&#32852;&#39118;&#26684;(cascade style)&#26159;&#21487;&#32452;&#21512;&#30340;:
        </p><pre class="programlisting">&lt;one-to-one name="person" cascade="persist,delete,lock"/&gt;</pre><p>
            &#20320;&#21487;&#20197;&#20351;&#29992;<tt class="literal">cascade="all"</tt>&#26469;&#25351;&#23450;<span class="emphasis"><em>&#20840;&#37096;</em></span>&#25805;&#20316;&#37117;&#39034;&#30528;&#20851;&#32852;&#20851;&#31995;&#32423;&#32852;(cascaded)&#12290;
			&#40664;&#35748;&#20540;&#26159;<tt class="literal">cascade="none"</tt>&#65292;&#21363;&#20219;&#20309;&#25805;&#20316;&#37117;&#19981;&#20250;&#34987;&#32423;&#32852;(cascaded)&#12290;
        </p><p>
        	&#27880;&#24847;&#26377;&#19968;&#20010;&#29305;&#27530;&#30340;&#32423;&#32852;&#39118;&#26684;(cascade style) <tt class="literal">delete-orphan</tt>&#65292;&#21482;&#24212;&#29992;&#20110;one-to-many&#20851;&#32852;&#65292;&#34920;&#26126;<tt class="literal">delete()</tt>&#25805;&#20316;
        	&#24212;&#35813;&#34987;&#24212;&#29992;&#20110;&#25152;&#26377;&#20174;&#20851;&#32852;&#20013;&#21024;&#38500;&#30340;&#23545;&#35937;&#12290;
        </p><p>
            &#24314;&#35758;:
        </p><div class="itemizedlist"><ul type="disc" compact><li><p>
                	&#36890;&#24120;&#22312;<tt class="literal">&lt;many-to-one&gt;</tt>&#25110;<tt class="literal">&lt;many-to-many&gt;</tt>&#20851;&#31995;&#20013;&#24212;&#29992;&#32423;&#32852;(cascade)&#27809;&#20160;&#20040;&#24847;&#20041;&#12290;
					&#32423;&#32852;(cascade)&#36890;&#24120;&#22312; <tt class="literal">&lt;one-to-one&gt;</tt>&#21644;<tt class="literal">&lt;one-to-many&gt;</tt>&#20851;&#31995;&#20013;&#27604;&#36739;&#26377;&#29992;&#12290;
                </p></li><li><p>
                	&#22914;&#26524;&#23376;&#23545;&#35937;&#30340;&#23551;&#21629;&#38480;&#23450;&#22312;&#29238;&#20146;&#23545;&#35937;&#30340;&#23551;&#21629;&#20043;&#20869;&#65292;&#21487;&#36890;&#36807;&#25351;&#23450;<tt class="literal">cascade="all,delete-orphan"</tt>&#23558;&#20854;&#21464;&#20026;<span class="emphasis"><em>&#33258;&#21160;&#29983;&#21629;&#21608;&#26399;&#31649;&#29702;&#30340;&#23545;&#35937;(lifecycle object)</em></span>&#12290;
                </p></li><li><p>
                	&#20854;&#20182;&#24773;&#20917;&#65292;&#20320;&#21487;&#26681;&#26412;&#19981;&#38656;&#35201;&#32423;&#32852;(cascade)&#12290;&#20294;&#26159;&#22914;&#26524;&#20320;&#35748;&#20026;&#20320;&#20250;&#32463;&#24120;&#22312;&#26576;&#20010;&#20107;&#21153;&#20013;&#21516;&#26102;&#29992;&#21040;&#29238;&#23545;&#35937;&#19982;&#23376;&#23545;&#35937;&#65292;&#24182;&#19988;&#20320;&#24076;&#26395;&#23569;&#25171;&#28857;&#20799;&#23383;&#65292;&#21487;&#20197;&#32771;&#34385;&#20351;&#29992;<tt class="literal">cascade="persist,merge,save-update"</tt>&#12290;
                </p></li></ul></div><p>
        	&#21487;&#20197;&#20351;&#29992;<tt class="literal">cascade="all"</tt>&#23558;&#19968;&#20010;&#20851;&#32852;&#20851;&#31995;&#65288;&#26080;&#35770;&#26159;&#23545;&#20540;&#23545;&#35937;&#30340;&#20851;&#32852;&#65292;&#25110;&#32773;&#23545;&#19968;&#20010;&#38598;&#21512;&#30340;&#20851;&#32852;&#65289;&#26631;&#35760;&#20026;<span class="emphasis"><em>&#29238;/&#23376;</em></span>&#20851;&#31995;&#30340;&#20851;&#32852;&#12290;
        	&#36825;&#26679;&#23545;&#29238;&#23545;&#35937;&#36827;&#34892;save/update/delete&#25805;&#20316;&#23601;&#20250;&#23548;&#33268;&#23376;&#23545;&#35937;&#20063;&#36827;&#34892;save/update/delete&#25805;&#20316;&#12290;
        </p><p>
        	&#27492;&#22806;&#65292;&#19968;&#20010;&#25345;&#20037;&#30340;&#29238;&#23545;&#35937;&#23545;&#23376;&#23545;&#35937;&#30340;&#27973;&#24341;&#29992;(mere reference)&#20250;&#23548;&#33268;&#23376;&#23545;&#35937;&#34987;&#21516;&#27493;save/update&#12290;
        	&#19981;&#36807;&#65292;&#36825;&#20010;&#38544;&#21947;(metaphor)&#30340;&#35828;&#27861;&#24182;&#19981;&#23436;&#25972;&#12290;&#38500;&#38750;&#20851;&#32852;&#26159;<tt class="literal">&lt;one-to-many&gt;</tt>&#20851;&#32852;&#24182;&#19988;&#34987;&#26631;&#35760;&#20026;<tt class="literal">cascade="delete-orphan"</tt>&#65292;
        	&#21542;&#21017;&#29238;&#23545;&#35937;&#22833;&#21435;&#23545;&#26576;&#20010;&#23376;&#23545;&#35937;&#30340;&#24341;&#29992;<span class="emphasis"><em>&#19981;&#20250;</em></span>&#23548;&#33268;&#35813;&#23376;&#23545;&#35937;&#34987;&#33258;&#21160;&#21024;&#38500;&#12290;
        	&#29238;&#23376;&#20851;&#31995;&#30340;&#32423;&#32852;(cascading)&#25805;&#20316;&#20934;&#30830;&#35821;&#20041;&#22914;&#19979;&#65306;
        </p><div class="itemizedlist"><ul type="disc" compact><li><p>
                    &#22914;&#26524;&#29238;&#23545;&#35937;&#34987;<tt class="literal">persist()</tt>&#65292;&#37027;&#20040;&#25152;&#26377;&#23376;&#23545;&#35937;&#20063;&#20250;&#34987;<tt class="literal">persist()</tt>
                </p></li><li><p>
                     &#22914;&#26524;&#29238;&#23545;&#35937;&#34987;<tt class="literal">merge()</tt>&#65292;&#37027;&#20040;&#25152;&#26377;&#23376;&#23545;&#35937;&#20063;&#20250;&#34987;<tt class="literal">merge()</tt>
                </p></li><li><p>
                     &#22914;&#26524;&#29238;&#23545;&#35937;&#34987;<tt class="literal">save()</tt>&#65292;<tt class="literal">update()</tt>&#25110;
                    <tt class="literal">saveOrUpdate()</tt>&#65292;&#37027;&#20040;&#25152;&#26377;&#23376;&#23545;&#35937;&#21017;&#20250;&#34987;<tt class="literal">saveOrUpdate()</tt>
                </p></li><li><p>
                	&#22914;&#26524;&#26576;&#20010;&#25345;&#20037;&#30340;&#29238;&#23545;&#35937;&#24341;&#29992;&#20102;&#30636;&#26102;(transient)&#25110;&#32773;&#33073;&#31649;(detached)&#30340;&#23376;&#23545;&#35937;&#65292;&#37027;&#20040;&#23376;&#23545;&#35937;&#23558;&#20250;&#34987;<tt class="literal">saveOrUpdate()</tt>
                </p></li><li><p>
                    &#22914;&#26524;&#29238;&#23545;&#35937;&#34987;&#21024;&#38500;&#65292;&#37027;&#20040;&#25152;&#26377;&#23376;&#23545;&#35937;&#20063;&#20250;&#34987;<tt class="literal">delete()</tt>
                </p></li><li><p>
                	&#38500;&#38750;&#34987;&#26631;&#35760;&#20026;<tt class="literal">cascade="delete-orphan"</tt>&#65288;&#21024;&#38500;&#8220;&#23396;&#20799;&#8221;&#27169;&#24335;&#65292;&#27492;&#26102;&#19981;&#34987;&#20219;&#20309;&#19968;&#20010;&#29238;&#23545;&#35937;&#24341;&#29992;&#30340;&#23376;&#23545;&#35937;&#20250;&#34987;&#21024;&#38500;&#65289;&#65292;
                	&#21542;&#21017;&#23376;&#23545;&#35937;&#22833;&#25481;&#29238;&#23545;&#35937;&#23545;&#20854;&#30340;&#24341;&#29992;&#26102;&#65292;<span class="emphasis"><em>&#20160;&#20040;&#20107;&#20063;&#19981;&#20250;&#21457;&#29983;</em></span>&#12290;
                	&#22914;&#26524;&#26377;&#29305;&#27530;&#38656;&#35201;&#65292;&#24212;&#29992;&#31243;&#24207;&#21487;&#36890;&#36807;&#26174;&#24335;&#35843;&#29992;delete()&#21024;&#38500;&#23376;&#23545;&#35937;&#12290;
                </p></li></ul></div><p>
            &#26368;&#21518;&#65292;&#27880;&#24847;&#25805;&#20316;&#30340;&#32423;&#32852;&#21487;&#33021;&#26159;&#22312;<span class="emphasis"><em>&#35843;&#29992;&#26399;(call time)</em></span>&#25110;&#32773;<span class="emphasis"><em>&#20889;&#20837;&#26399;(flush time)</em></span>&#20316;&#29992;&#21040;&#23545;&#35937;&#22270;&#19978;&#30340;&#12290;&#25152;&#26377;&#30340;&#25805;&#20316;&#65292;&#22914;&#26524;&#20801;&#35768;&#65292;&#37117;&#22312;&#25805;&#20316;&#34987;&#25191;&#34892;&#30340;&#26102;&#20505;&#32423;&#32852;&#21040;&#21487;&#35302;&#21450;&#30340;&#20851;&#32852;&#23454;&#20307;&#19978;&#12290;&#28982;&#32780;&#65292;<tt class="literal">save-upate</tt>&#21644;<tt class="literal">delete-orphan</tt>&#26159;&#22312;<tt class="literal">Session</tt> flush&#30340;&#26102;&#20505;&#25165;&#20316;&#29992;&#21040;&#25152;&#26377;&#21487;&#35302;&#21450;&#30340;&#34987;&#20851;&#32852;&#23545;&#35937;&#19978;&#30340;&#12290;
        </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="objectstate-metadata"></a>10.12.&nbsp;&#20351;&#29992;&#20803;&#25968;&#25454;</h2></div></div><div></div></div><p>
            Hibernate&#20013;&#26377;&#19968;&#20010;&#38750;&#24120;&#20016;&#23500;&#30340;&#20803;&#32423;&#21035;(meta-level)&#30340;&#27169;&#22411;&#65292;&#21547;&#26377;&#25152;&#26377;&#30340;&#23454;&#20307;&#21644;&#20540;&#31867;&#22411;&#25968;&#25454;&#30340;&#20803;&#25968;&#25454;&#12290;
              &#26377;&#26102;&#36825;&#20010;&#27169;&#22411;&#23545;&#24212;&#29992;&#31243;&#24207;&#26412;&#36523;&#20063;&#20250;&#38750;&#24120;&#26377;&#29992;&#12290;
              &#27604;&#22914;&#35828;&#65292;&#24212;&#29992;&#31243;&#24207;&#21487;&#33021;&#22312;&#23454;&#29616;&#19968;&#31181;&#8220;&#26234;&#33021;&#8221;&#30340;&#28145;&#24230;&#25335;&#36125;&#31639;&#27861;&#26102;&#65292;
              &#36890;&#36807;&#20351;&#29992;Hibernate&#30340;&#20803;&#25968;&#25454;&#26469;&#20102;&#35299;&#21738;&#20123;&#23545;&#35937;&#24212;&#35813;&#34987;&#25335;&#36125;&#65288;&#27604;&#22914;&#65292;&#21487;&#21464;&#30340;&#20540;&#31867;&#22411;&#25968;&#25454;&#65289;&#65292;
              &#37027;&#20123;&#19981;&#24212;&#35813;&#65288;&#19981;&#21487;&#21464;&#30340;&#20540;&#31867;&#22411;&#25968;&#25454;&#65292;&#20063;&#35768;&#36824;&#26377;&#26576;&#20123;&#34987;&#20851;&#32852;&#30340;&#23454;&#20307;&#65289;&#12290;
        </p><p>
            Hibernate&#25552;&#20379;&#20102;<tt class="literal">ClassMetadata</tt>&#25509;&#21475;&#65292;<tt class="literal">CollectionMetadata</tt>&#25509;&#21475;&#21644;<tt class="literal">Type</tt>&#23618;&#27425;&#20307;&#31995;&#26469;&#35775;&#38382;&#20803;&#25968;&#25454;&#12290;
              &#21487;&#20197;&#36890;&#36807;<tt class="literal">SessionFactory</tt>&#33719;&#21462;&#20803;&#25968;&#25454;&#25509;&#21475;&#30340;&#23454;&#20363;&#12290;
        </p><pre class="programlisting">Cat fritz = ......;
ClassMetadata catMeta = sessionfactory.getClassMetadata(Cat.class);

Object[] propertyValues = catMeta.getPropertyValues(fritz);
String[] propertyNames = catMeta.getPropertyNames();
Type[] propertyTypes = catMeta.getPropertyTypes();

// get a Map of all properties which are not collections or associations
Map namedValues = new HashMap();
for ( int i=0; i&lt;propertyNames.length; i++ ) {
    if ( !propertyTypes[i].isEntityType() &amp;&amp; !propertyTypes[i].isCollectionType() ) {
        namedValues.put( propertyNames[i], propertyValues[i] );
    }
}</pre></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="inheritance.html">&#19978;&#19968;&#39029;</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="index.html">&#19978;&#19968;&#32423;</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="transactions.html">&#19979;&#19968;&#39029;</a></td></tr><tr><td width="40%" align="left" valign="top">&#31532;&nbsp;9&nbsp;&#31456;&nbsp;&#32487;&#25215;&#26144;&#23556;(Inheritance Mappings)&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">&#36215;&#22987;&#39029;</a></td><td width="40%" align="right" valign="top">&nbsp;&#31532;&nbsp;11&nbsp;&#31456;&nbsp;&#20107;&#21153;&#21644;&#24182;&#21457;</td></tr></table></div></body></html>